<!doctype html>
<html class="w-full antialiased" lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Understanding Navigation in LiveView Native</title>
    <meta name="description" content="Today, we&#39;ll go through the implementation of the main navigation patterns needed to traverse our app&#39;s sections and views.">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">

    <link rel="icon" type="image/x-icon" href="/img/favicon.ico">
    <link
    rel="stylesheet" href="/css/style_v2.css?v2">
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/@alpinejs/intersect@3.x.x/dist/cdn.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/@alpinejs/focus@3.x.x/dist/cdn.min.js"></script>
    <script nomodule src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="Bonfire">
    <script src="//unpkg.com/alpinejs" defer></script>
    <link href="https://unpkg.com/prismjs@1.20.0/themes/prism-okaidia.css" rel="stylesheet">
  </head>
  <body data-theme="bonfire" class="body-theme w-full bg-base-100 antialiased">
    <div
      class="sticky bg-base-100 top-0 z-[999999999999999999] transition duration-500 ease-in-out"
      x-data="{open: false, atTop: false}" 
    >
    

    <div class="max-w-screen-lg mx-auto">
      <header class="relative z-30 lg:px-0 mx-auto navbar">
        <div class="navbar-start w-[30%]">
          <div class="flex  items-center flex-shrink-0">
            <a href="/" class="flex items-center space-x-4">
              <span class="block bg-center bg-no-repeat bg-cover" style="width: 30px; height: 40px; background-image: url(/img/bonfire.png)"></span>  
              <span class="flex items-center"><span class="text-base font-black tracking-wider text-base-content">Bonfire</span> 
              
              </span>
            </a>
          </div>
           
        



        </div>
        
        <div class="navbar-end w-[70%]">

            <div class="hidden xl:flex w-full justify-end mr-3">
          <ul class="flex-row  p-0 font-medium menu font-bold menu-horizontal">
            <li>
              <a href="/about" role="button" tabindex="0" class="flex font-semiboltext-[15px] items-center gap-2 ">
                <span>About</span>
              </a>
            </li>
            <li class="dropdown">
                <div tabindex="0" class="flex    font-semiboltext-[15px] items-center gap-2">
                  <span>Ecosystem</span>
                  <svg class="fill-current" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path d="M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"/></svg>
                </div>
              
              <ul tabindex="0" class="dropdown-content min-w-[280px] border border-base-content/20 !ml-0 menu mt-2 p-1 bg-base-100 rounded-lg">
                <li>
                  <a href="/apps" class="flex flex-col rounded-lg flex-wrap items-start">
                      <div class="font-bold">Apps</div>
                      <div class="font-light -mt-1.5  text-sm    font-light">Apps built with Bonfire</div>
                  </a>
                </li>
                <li>
                  <a href="/extensions" class="flex flex-col rounded-lg flex-wrap items-start" >
                      <div class="font-bold">Extensions</div>
                      <div class="font-light -mt-1.5  text-sm    font-light">Explore available extensions</div>
                  </a>
                </li>
                <li>
                  <a href="/hosting" class="flex flex-col rounded-lg flex-wrap items-start" >
                      <div class="font-bold">Hosting</div>
                      <div class="font-light -mt-1.5  text-sm    font-light">How to host Bonfire</div>
                  </a>
                </li>
                
                  
                <li>
                  <a class="flex flex-col rounded-lg flex-wrap items-start" href="/community">
                      <div class="font-bold">How to participate</div>
                      <div class="font-light -mt-1.5  text-sm    font-light">Contribute to Bonfire</div>
                  </a>
                </li>
              </ul>
            </li>
            <li class="dropdown">
                <div tabindex="0" class="flex    font-semiboltext-[15px] items-center gap-2">
                  <span>Learn</span>
                  <svg class="fill-current" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path d="M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"/></svg>
                </div>
              <ul tabindex="0" class="dropdown-content min-w-[280px] border border-base-content/30 !ml-0 menu mt-2 p-1 bg-base-300 rounded-lg ">
                <li>
                  <a class="flex flex-col rounded-lg flex-wrap items-start" href="https://doc.bonfirenetworks.org">
                      <div class="font-semibold">Documentation</div>
                      <div class="font-light text-sm    -mt-1.5">Dive into using or building on Bonfire</div>
                  </a>
                </li>
                 <li>
                  <a class="flex flex-col rounded-lg flex-wrap items-start" href="/design">
                      <div class="font-semibold">Design</div>
                      <div class="font-light text-sm    -mt-1.5">Think with Bonfire to create better digital spaces</div>
                  </a>
                </li>
                <li>
                  <a class="flex rounded-lg flex-col flex-wrap items-start" href="/community">
                      <div class="font-semibold">Community</div>
                      <div class="font-light text-sm    -mt-1.5">How to participate in the ecosystem</div>
                  </a>
                </li>
                <li>
                  <a class="flex rounded-lg flex-col flex-wrap items-start" href="/faq">
                    <div class="font-semibold">FAQ</div>
                    <div class="text-sm -mt-1.5 font-light   ">Frequently asked questions</div>
                  </a>
                </li>
                
                
                <li> 
                  <a class="flex flex-col rounded-lg flex-wrap items-start" href="https://github.com/bonfire-networks/bonfire-app" target="_blank">
                    <div class="font-semibold">Get the code</div>
                    <div class="font-light text-sm    -mt-1.5">Bonfire is open source and AGPL3 licensed</div>
                  </a>
                </li>
              </ul>
            </li>
            
            <li>
            <a href="/mosaic" class="font-semibold  text-[15px]  ">
              <span class="">Mosaic</span>
            </a>
            </li>

            <li>
            <a href="/blog" class="font-semibold  text-[15px]  ">
              <span class="">News</span>
            </a>
            </li>
          </ul>
        </div>

           
          <a href="/start/" >
            <span class="btn-sm w-[120px] hidden font-bold normal-case btn btn-primary xl:flex">Get Bonfire</span>
          </a>

          <label for="theme_controller" class="swap swap-rotate mx-3">
  
              <!-- this hidden checkbox controls the state -->
              <input id="theme_controller" type="checkbox" class="theme-controller" value="bonfire" />
              
              <!-- sun icon -->
              <svg class="swap-on fill-current w-6 h-6" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5.64,17l-.71.71a1,1,0,0,0,0,1.41,1,1,0,0,0,1.41,0l.71-.71A1,1,0,0,0,5.64,17ZM5,12a1,1,0,0,0-1-1H3a1,1,0,0,0,0,2H4A1,1,0,0,0,5,12Zm7-7a1,1,0,0,0,1-1V3a1,1,0,0,0-2,0V4A1,1,0,0,0,12,5ZM5.64,7.05a1,1,0,0,0,.7.29,1,1,0,0,0,.71-.29,1,1,0,0,0,0-1.41l-.71-.71A1,1,0,0,0,4.93,6.34Zm12,.29a1,1,0,0,0,.7-.29l.71-.71a1,1,0,1,0-1.41-1.41L17,5.64a1,1,0,0,0,0,1.41A1,1,0,0,0,17.66,7.34ZM21,11H20a1,1,0,0,0,0,2h1a1,1,0,0,0,0-2Zm-9,8a1,1,0,0,0-1,1v1a1,1,0,0,0,2,0V20A1,1,0,0,0,12,19ZM18.36,17A1,1,0,0,0,17,18.36l.71.71a1,1,0,0,0,1.41,0,1,1,0,0,0,0-1.41ZM12,6.5A5.5,5.5,0,1,0,17.5,12,5.51,5.51,0,0,0,12,6.5Zm0,9A3.5,3.5,0,1,1,15.5,12,3.5,3.5,0,0,1,12,15.5Z"/></svg>
              
              <!-- moon icon -->
              <svg class="swap-off fill-current w-6 h-6" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21.64,13a1,1,0,0,0-1.05-.14,8.05,8.05,0,0,1-3.37.73A8.15,8.15,0,0,1,9.08,5.49a8.59,8.59,0,0,1,.25-2A1,1,0,0,0,8,2.36,10.14,10.14,0,1,0,22,14.05,1,1,0,0,0,21.64,13Zm-9.5,6.69A8.14,8.14,0,0,1,7.08,5.22v.27A10.15,10.15,0,0,0,17.22,15.63a9.79,9.79,0,0,0,2.1-.22A8.11,8.11,0,0,1,12.14,19.73Z"/></svg>
            </label>
          <div class="inset-y-0 right-0 flex gap-3 items-center xl:hidden">
            <a href="/start/" >
              <span class="normal-case rounded-full btn btn-sm btn-primary">Get started</span>
            </a>
              <span class="sr-only">Open main menu</span>
              <label class="btn btn-circle btn-ghost swap swap-rotate">
  
              <!-- this hidden checkbox controls the state -->
              <input type="checkbox" />
              
              <!-- hamburger icon -->
              <svg @click="open = !open" class="swap-off fill-current" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 512 512"><path d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z"/></svg>
              
              <!-- close icon -->
              <svg @click="open = !open" class="swap-on fill-current" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 512 512"><polygon points="400 145.49 366.51 112 256 222.51 145.49 112 112 145.49 222.51 256 112 366.51 145.49 400 256 289.49 366.51 400 400 366.51 289.49 256 400 145.49"/></svg>
              
            </label>
          </div>

        </div>
      

    
      </header>
    </div>
    <div 
      x-description="Mobile menu, show/hide based on menu state." 
      class="xl:hidden" 
      id="mobile-menu" 
      x-show="open" 
      style="display: none;">
      <ul class="p-0 menu bg-base-300">
          <li>
            <a href="/about" class=" ">
            <span class="text-base font-regular">About</span>
          </a>
          </li>

            <li>
            <a href="/apps" class=" ">
            <span class="text-base font-regular">Apps</span>
          </a>
          </li>

          <li>
            <a href="/extensions" class=" ">
            <span class="text-base font-regular">Extensions</span>
          </a>
          </li>

          


            <li>
            <a href="/docs" class=" ">
            <span class="text-base font-regular">Documentation</span>
          </a>
          </li>

          
          
          
          
          <li>
            <a href="/faq" class=" ">
            <span class="text-base font-regular">FAQs</span>
          </a>
          </li>
          <li>
          <a href="/blog" class=" ">
            <span class="text-base font-regular">News</span>
          </a>
          </li>
          <li>
            <a href="/community" class=" ">
              <span class="text-base font-regular">Community</span>
            </a>
          </li>

          <li>
            <a href="https://github.com/bonfire-networks/bonfire-app" class="">
              <span class="text-base font-regular">Get the code</span>
            </a>
          </li>
          
      </ul>
    </div>
  </div>

 <script>
    document.addEventListener('DOMContentLoaded', (event) => {
    const themeController = document.querySelector('.theme-controller');
    const bodyElement = document.body;

    // Load the saved theme from localStorage
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme) {
        themeController.checked = savedTheme === 'bonfire';
        bodyElement.setAttribute('data-theme', savedTheme);
    }

    // Save the theme to localStorage whenever it changes
    themeController.addEventListener('change', (event) => {
        const theme = event.target.checked ? 'bonfire' : 'light';
        localStorage.setItem('theme', theme);
        bodyElement.setAttribute('data-theme', theme);
    });
});
</script>
    

<div class="max-w-screen-md px-6 mx-auto mt-0 mb-12 lg:px-0">
  <div class="py-8 pb-8 mx-auto">
    <div class="">
       
     <div class="items-center justify-center mb-6 place-content-center flex gap-4"><a href="/tags/development/">
        <span class="badge capitalize badge-lg badge-outline">
          development
        </span>
        </a>
      </div>
      <h1 style="line-height: 50px;" class="z-10 col-span-2 text-4xl font-bold text-center">Understanding Navigation in LiveView Native</h1>
     
     

      
        <img src="/img/nav_bg.png" alt="post image" class="w-full max-h-[520px] mt-6 rounded-box object-fit object-cover" />
      
        
    </div>
  </div>

  <article class="max-w-screen-md mx-auto mt-12 prose prose-xl">
    <p><strong>Read part one: <a href="/posts/dev_diary_lvn">Building Bonfire Native Apps with LiveView Native</a></strong><br>
<strong>Read part two: <a href="/posts/dev_diary_lvn_2">Prototyping Our First Native Components with LiveView Native</a></strong></p>
<hr>
<blockquote>
<p><strong>Note</strong>: This entry may evolve over time as the LiveView Native team pushes improvements and releases major versions of the libraries. Please bear with us as we test and implement the main navigation patterns in our upcoming Bonfire native app! Also, this article reflects our current understanding of SwiftUI and LiveView Native; we would love to get feedback and improve any parts that are not accurate!</p>
</blockquote>
<p><em>Thanks to the LiveView Native team for their feedback and support! üî•</em></p>
<p>In our previous article, we experimented with building some simple UI components that we'll be using across the Bonfire app, and at the same time, we've developed some initial confidence in writing LiveView Native (LVN) code.</p>
<p>Today, we'll go through the implementation of the main navigation patterns needed to traverse our app's sections and views.</p>
<h2 id="liveview-native-navigation">LiveView Native Navigation <a class="direct-link" href="#liveview-native-navigation">#</a></h2>
<p>In SwiftUI, there are three main ways to navigate an app:</p>
<ul>
<li><strong>Tab Bar</strong></li>
<li><strong>Navigation Bar</strong></li>
<li><strong>Links</strong></li>
</ul>
<p>The destination can be a different section in the same view, a different page, a sheet (modal), or an external view.</p>
<p>In LiveView Native, all the routing and navigation happens within the <code>NavigationStack</code> view, which is included by default in the <code>root.swiftui.leex</code> and wraps all the views defined in the <code>router.ex</code> module.</p>
<p>The LVN documentation is a great starting point to learn more about how navigation works:</p>
<ul>
<li><a href="https://hexdocs.pm/live_view_native_swiftui/0.3.0/native-navigation.html">Native Navigation</a></li>
<li><a href="https://hexdocs.pm/live_view_native_swiftui/0.3.0/navigation.html">Navigation</a></li>
</ul>
<h2 id="the-tabview">The TabView <a class="direct-link" href="#the-tabview">#</a></h2>
<p>The <strong>TabView</strong> is a default SwiftUI component fixed at the bottom of a view. It consists of up to five navigation items (icons only or icons with text‚Äîalthough text is usually recommended if you're showing a maximum of three buttons) and is used for top-level navigation between major sections of a single view.</p>
<p>In SwiftUI, the <a href="https://developer.apple.com/documentation/swiftui/TabView">TabView</a> is defined as:</p>
<blockquote>
<p><strong>TabView</strong>: A view that switches between multiple child views using interactive user interface elements.</p>
</blockquote>
<p>To include a <code>TabView</code> in LVN, we need to use the default <code>&lt;TabView&gt;</code> component.</p>
<p>The <a href="https://github.com/jtormey/lax/blob/4fb54e6071abf69b65a2fdc80db271c3e8fc47c0/lib/lax_web/live/chat_live/chat_components.swiftui.ex#L26">Lax repository</a> provides a couple of custom components to implement a <code>TabView</code> in an elegant and simple way‚Äîwe copy-pasted them into our app in no time ü•∏Ô∏èÔ∏èÔ∏èÔ∏èÔ∏èÔ∏è !</p>
<pre class="language-elixir"><code class="language-elixir">attr <span class="token atom symbol">:rest</span><span class="token punctuation">,</span> <span class="token atom symbol">:global</span><span class="token punctuation">,</span> <span class="token attr-name">include:</span> <span class="token string">~w(phx-change selection)</span>
slot <span class="token atom symbol">:inner_block</span><span class="token punctuation">,</span> <span class="token attr-name">required:</span> <span class="token boolean">true</span>

<span class="token keyword">def</span> <span class="token function">tab_bar</span><span class="token punctuation">(</span>assigns<span class="token punctuation">)</span> <span class="token keyword">do</span>
~<span class="token module class-name">LVN</span><span class="token string">"""
  &lt;TabView {@rest}>
    &lt;%= render_slot(@inner_block) %>
  &lt;/TabView>
"""</span>
<span class="token keyword">end</span>

attr <span class="token atom symbol">:tag</span><span class="token punctuation">,</span> <span class="token atom symbol">:any</span><span class="token punctuation">,</span> <span class="token attr-name">required:</span> <span class="token boolean">true</span>
attr <span class="token atom symbol">:name</span><span class="token punctuation">,</span> <span class="token atom symbol">:string</span><span class="token punctuation">,</span> <span class="token attr-name">required:</span> <span class="token boolean">true</span>
attr <span class="token atom symbol">:icon_system_name</span><span class="token punctuation">,</span> <span class="token atom symbol">:string</span><span class="token punctuation">,</span> <span class="token attr-name">required:</span> <span class="token boolean">true</span>
slot <span class="token atom symbol">:inner_block</span><span class="token punctuation">,</span> <span class="token attr-name">required:</span> <span class="token boolean">true</span>

<span class="token keyword">def</span> <span class="token function">tab</span><span class="token punctuation">(</span>assigns<span class="token punctuation">)</span> <span class="token keyword">do</span>
	~<span class="token module class-name">LVN</span><span class="token string">"""
	&lt;Group tag={@tag} style="tabItem(:tab);">
	  &lt;Image template={:tab} systemName={@icon_system_name} />
	  &lt;Text template={:tab}>&lt;%= @name %>&lt;/Text>
	  &lt;%= render_slot(@inner_block) %>
	&lt;/Group>
	"""</span>
<span class="token keyword">end</span></code></pre>
<p>Then we just had to import them into our view like this:</p>
<pre class="language-elixir"><code class="language-elixir">&lt;<span class="token module class-name">VStack</span>>
  <span class="token operator">&lt;</span><span class="token punctuation">.</span>tab_bar phx<span class="token operator">-</span>change<span class="token operator">=</span><span class="token string">"swiftui_tab_selection"</span> selection<span class="token operator">=</span><span class="token punctuation">{</span><span class="token attribute variable">@swiftui_tab</span><span class="token punctuation">}</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token punctuation">.</span>tab tag<span class="token operator">=</span><span class="token punctuation">{</span><span class="token atom symbol">:home</span><span class="token punctuation">}</span> name<span class="token operator">=</span><span class="token string">""</span> icon_system_name<span class="token operator">=</span><span class="token string">"square.stack"</span>>
      <span class="token operator">&lt;</span><span class="token module class-name">Text</span>><span class="token module class-name">Home</span>&lt;<span class="token operator">/</span><span class="token module class-name">Text</span>>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token punctuation">.</span>tab<span class="token operator">></span>

	<span class="token operator">&lt;</span><span class="token punctuation">.</span>tab tag<span class="token operator">=</span><span class="token punctuation">{</span><span class="token atom symbol">:notifications</span><span class="token punctuation">}</span> name<span class="token operator">=</span><span class="token string">""</span> icon_system_name<span class="token operator">=</span><span class="token string">"bell"</span>>
		<span class="token operator">&lt;</span><span class="token module class-name">Text</span>><span class="token module class-name">Notifications</span>&lt;<span class="token operator">/</span><span class="token module class-name">Text</span>>
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token punctuation">.</span>tab<span class="token operator">></span>
	
	<span class="token operator">&lt;</span><span class="token punctuation">.</span>tab tag<span class="token operator">=</span><span class="token punctuation">{</span><span class="token atom symbol">:search</span><span class="token punctuation">}</span> name<span class="token operator">=</span><span class="token string">""</span> icon_system_name<span class="token operator">=</span><span class="token string">"magnifyingglass"</span>>
		<span class="token operator">&lt;</span><span class="token module class-name">Text</span>><span class="token module class-name">Search</span>&lt;<span class="token operator">/</span><span class="token module class-name">Text</span>>
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token punctuation">.</span>tab<span class="token operator">></span>
	
	<span class="token operator">&lt;</span><span class="token punctuation">.</span>tab tag<span class="token operator">=</span><span class="token punctuation">{</span><span class="token atom symbol">:direct_messages</span><span class="token punctuation">}</span> name<span class="token operator">=</span><span class="token string">""</span> icon_system_name<span class="token operator">=</span><span class="token string">"tray"</span>>
		<span class="token operator">&lt;</span><span class="token module class-name">Text</span>><span class="token module class-name">DMs</span>&lt;<span class="token operator">/</span><span class="token module class-name">Text</span>>
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token punctuation">.</span>tab<span class="token operator">></span>
	
	<span class="token operator">&lt;</span><span class="token punctuation">.</span>tab tag<span class="token operator">=</span><span class="token punctuation">{</span><span class="token atom symbol">:profile</span><span class="token punctuation">}</span> name<span class="token operator">=</span><span class="token string">""</span> icon_system_name<span class="token operator">=</span><span class="token string">"person.crop.circle"</span>>
		<span class="token operator">&lt;</span><span class="token module class-name">Text</span>><span class="token module class-name">Profile</span>&lt;<span class="token operator">/</span><span class="token module class-name">Text</span>>
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token punctuation">.</span>tab<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token punctuation">.</span>tab_bar<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token module class-name">VStack</span>></code></pre>
<p>And this is the result:</p>
<p><img src="/img/basic.gif" alt="Tab View Screenshot"></p>
<blockquote>
<p><strong>Note</strong>: Currently, you can include only functional components as slots within each <code>&lt;.tab&gt;</code>. It is not possible to include sub-LiveViews‚Äîthis may evolve with future releases of the LiveView Native Core library.</p>
</blockquote>
<p>The <code>TabView</code> is mostly this; it resembles the standard <code>&lt;Tabs&gt;</code> web design pattern: it lets the user navigate different content of the same page, highlighting the currently active <code>&lt;Tab&gt;</code> component.</p>
<h3 id="the-toolbar-navigation">The Toolbar Navigation <a class="direct-link" href="#the-toolbar-navigation">#</a></h3>
<p>We found the toolbar navigation trickier to implement, probably because of the various user experiences and customizations we required.</p>
<blockquote>
<p><strong>Note</strong>: We highly recommend the article <a href="https://holyswift.app/how-to-create-toolbar-in-swiftui/">How to Create Toolbar in SwiftUI</a> to learn more about the different types of actions and properties you can leverage to build the toolbar.</p>
</blockquote>
<p>In our case, our main issue consisted of having to switch between three different types of toolbars based upon the current active page.</p>
<p>As mentioned earlier, the <code>&lt;TabView&gt;</code> component only accepts functional components as slots for each <code>&lt;Tab&gt;</code>. Additionally, we can only define a single <code>&lt;Toolbar&gt;</code> for each view.</p>
<p>This means that based on the active <code>tab</code>, we need to programmatically change the <code>toolbar</code> structure to customize it according to the needs of the rendered component.</p>
<p>As far as we know, the current version of LVN doesn't include all the Optimistic UI features that are built into LiveView‚Äîor maybe it's just us doing something weird‚Äîbut we are experiencing a few minor bugs when trying to programmatically edit the toolbar when props change.</p>
<p>To add a basic toolbar, which includes only the navigation title, all you need is to include this code in your main view:</p>
<pre class="language-elixir"><code class="language-elixir">&lt;<span class="token module class-name">VStack</span> style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"navigationTitle(:title);"</span><span class="token punctuation">}</span><span class="token operator">></span>
	<span class="token operator">&lt;</span><span class="token module class-name">Text</span> template<span class="token operator">=</span><span class="token punctuation">{</span><span class="token atom symbol">:title</span><span class="token punctuation">}</span><span class="token operator">></span><span class="token module class-name">Home</span>&lt;<span class="token operator">/</span><span class="token module class-name">Text</span>>
<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token module class-name">VStack</span>></code></pre>
<p>This will add the standard iOS navigation title at the top of your view like:</p>
<p><img src="/img/nav1.png" alt="Tab View Screenshot"></p>
<p>From there, we can go further and add buttons at the top left and right, add the search bar, add an extra dropdown menu next to the title, change the position of the title, or edit the background.</p>
<p>We will need to apply all of the above in order to build toolbars like these:</p>
<p><img src="/img/nav2.png" alt="Tab View Screenshot"></p>
<p>iOS Toolbar provides ways for adding items and buttons on both the left and right. This is done by adding a <code>ToolbarItem</code> (or <code>ToolbarItemGroup</code> if you need to wrap more actions in the same component) and specifying a placement attribute. In order to add a <code>ToolbarItem</code>/<code>ToolbarItemGroup</code> in our toolbar, we need to specify it by including the <code>toolbar</code> modifier in our parent <code>VStack</code>: <code>toolbar(content: :toolbar)</code></p>
<p>Our code now looks like:</p>
<pre class="language-elixir"><code class="language-elixir">&lt;<span class="token module class-name">VStack</span> 
	style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span>
	  <span class="token string">"navigationTitle(:title)"</span><span class="token punctuation">,</span>
	  <span class="token string">"toolbar(content: :toolbar)"</span>
	  <span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token operator">></span>
	<span class="token operator">&lt;</span><span class="token module class-name">Text</span> template<span class="token operator">=</span><span class="token punctuation">{</span><span class="token atom symbol">:title</span><span class="token punctuation">}</span><span class="token operator">></span><span class="token module class-name">Home</span>&lt;<span class="token operator">/</span><span class="token module class-name">Text</span>>
<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token module class-name">VStack</span>></code></pre>
<p>This change alone is not enough though; we need to actually add the items we want to render.</p>
<pre class="language-elixir"><code class="language-elixir">&lt;<span class="token module class-name">VStack</span> 
	style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span>
	  <span class="token string">"navigationTitle(:title)"</span><span class="token punctuation">,</span>
	  <span class="token string">"toolbar(content: :toolbar)"</span>
	  <span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token operator">></span>
	<span class="token operator">&lt;</span><span class="token module class-name">Text</span> template<span class="token operator">=</span><span class="token punctuation">{</span><span class="token atom symbol">:title</span><span class="token punctuation">}</span><span class="token operator">></span><span class="token module class-name">Home</span>&lt;<span class="token operator">/</span><span class="token module class-name">Text</span>>
	<span class="token operator">&lt;</span><span class="token module class-name">ToolbarItemGroup</span> template<span class="token operator">=</span><span class="token string">"toolbar"</span> placement<span class="token operator">=</span><span class="token string">"navigationBarTrailing"</span>>
	  <span class="token operator">&lt;</span><span class="token module class-name">Button</span>>
		<span class="token operator">&lt;</span><span class="token punctuation">.</span>icon name<span class="token operator">=</span><span class="token string">"plus"</span> <span class="token operator">/</span>>
	  <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token module class-name">Button</span>>	
	<span class="token punctuation">.</span> <span class="token operator">&lt;</span><span class="token module class-name">Button</span>>
		<span class="token operator">&lt;</span><span class="token punctuation">.</span>icon name<span class="token operator">=</span><span class="token string">"gear"</span> <span class="token operator">/</span>>
	  <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token module class-name">Button</span>>
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token module class-name">ToolbarItemGroup</span>>
	<span class="token operator">&lt;</span><span class="token module class-name">ToolbarItem</span> template<span class="token operator">=</span><span class="token string">"toolbar"</span> placement<span class="token operator">=</span><span class="token string">"navigation"</span>>
		<span class="token operator">&lt;</span><span class="token punctuation">.</span>icon name<span class="token operator">=</span><span class="token string">"person.crop.circle"</span> <span class="token operator">/</span>>
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token module class-name">ToolbarItem</span>>
<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token module class-name">VStack</span>></code></pre>
<p>The <code>navigationBarTrailing</code> placement allows us to show the actions on the right side of the toolbar; using <code>navigation</code> places them on the left side.</p>
<p>The toolbar now looks like:</p>
<p><img src="/img/nav3.png" alt="Tab View Screenshot"></p>
<p>Getting better....</p>
<p>But we don't want the title that big, and we want to center it in the middle of the toolbar.</p>
<p>We have two possibilities:</p>
<ul>
<li><strong>Using <code>navigationBarTitleDisplayMode(.inline)</code></strong>: This moves the title to the center of the toolbar and reduces the font size at the same time.</li>
<li><strong>Using a <code>ToolbarItem</code> with <code>placement=&quot;principal&quot;</code></strong>: Insert a <code>&lt;Text&gt;</code> into it with the page title.</li>
</ul>
<p>If we use the latter option, we should remove the <code>&lt;Text template={:title}&gt;Home&lt;/Text&gt;</code> from the template.</p>
<p>Here's the updated code:</p>
<pre class="language-elixir"><code class="language-elixir">&lt;<span class="token module class-name">VStack</span> 
	style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span>
	  <span class="token string">"navigationTitle(:title)"</span><span class="token punctuation">,</span>
	  <span class="token string">"toolbar(content: :toolbar)"</span><span class="token punctuation">,</span>
	  <span class="token string">"navigationBarTitleDisplayMode(.inline)"</span>
	  <span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token operator">></span>
	<span class="token operator">&lt;</span><span class="token module class-name">Text</span> template<span class="token operator">=</span><span class="token punctuation">{</span><span class="token atom symbol">:title</span><span class="token punctuation">}</span><span class="token operator">></span><span class="token module class-name">Home</span>&lt;<span class="token operator">/</span><span class="token module class-name">Text</span>>
	<span class="token operator">&lt;</span><span class="token module class-name">ToolbarItemGroup</span> template<span class="token operator">=</span><span class="token string">"toolbar"</span> placement<span class="token operator">=</span><span class="token string">"navigationBarTrailing"</span>>
	  <span class="token operator">&lt;</span><span class="token module class-name">Button</span>>
		<span class="token operator">&lt;</span><span class="token punctuation">.</span>icon name<span class="token operator">=</span><span class="token string">"plus"</span> <span class="token operator">/</span>>
	  <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token module class-name">Button</span>>	
	<span class="token punctuation">.</span> <span class="token operator">&lt;</span><span class="token module class-name">Button</span>>
		<span class="token operator">&lt;</span><span class="token punctuation">.</span>icon name<span class="token operator">=</span><span class="token string">"gear"</span> <span class="token operator">/</span>>
	  <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token module class-name">Button</span>>
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token module class-name">ToolbarItemGroup</span>>
	<span class="token operator">&lt;</span><span class="token module class-name">ToolbarItem</span> template<span class="token operator">=</span><span class="token string">"toolbar"</span> placement<span class="token operator">=</span><span class="token string">"navigation"</span>>
		<span class="token operator">&lt;</span><span class="token punctuation">.</span>icon name<span class="token operator">=</span><span class="token string">"person.crop.circle"</span> <span class="token operator">/</span>>
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token module class-name">ToolbarItem</span>>
<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token module class-name">VStack</span>></code></pre>
<p>et voil√†...</p>
<p><img src="/img/nav4.png" alt="Tab View Screenshot"></p>
<p>The missing piece for our first toolbar, which we can implement using the <code>toolbarTitleMenu</code> modifier, is adding a dropdown menu next to the title:</p>
<pre class="language-elixir"><code class="language-elixir">&lt;<span class="token module class-name">VStack</span> 
	style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span>
	  <span class="token string">"navigationTitle(:title)"</span><span class="token punctuation">,</span>
	  <span class="token string">"toolbar(content: :toolbar)"</span><span class="token punctuation">,</span>
	  <span class="token string">"navigationBarTitleDisplayMode(.inline)"</span>
	  <span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token operator">></span>
	<span class="token operator">&lt;</span><span class="token module class-name">Text</span> template<span class="token operator">=</span><span class="token punctuation">{</span><span class="token atom symbol">:title</span><span class="token punctuation">}</span><span class="token operator">></span><span class="token module class-name">Home</span>&lt;<span class="token operator">/</span><span class="token module class-name">Text</span>>
	<span class="token operator">&lt;</span><span class="token module class-name">ToolbarItemGroup</span> template<span class="token operator">=</span><span class="token string">"toolbar"</span> placement<span class="token operator">=</span><span class="token string">"navigationBarTrailing"</span>>
	  <span class="token operator">&lt;</span><span class="token module class-name">Button</span>>
		<span class="token operator">&lt;</span><span class="token punctuation">.</span>icon name<span class="token operator">=</span><span class="token string">"plus"</span> <span class="token operator">/</span>>
	  <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token module class-name">Button</span>>	
	<span class="token punctuation">.</span> <span class="token operator">&lt;</span><span class="token module class-name">Button</span>>
		<span class="token operator">&lt;</span><span class="token punctuation">.</span>icon name<span class="token operator">=</span><span class="token string">"gear"</span> <span class="token operator">/</span>>
	  <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token module class-name">Button</span>>
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token module class-name">ToolbarItemGroup</span>>
	<span class="token operator">&lt;</span><span class="token module class-name">ToolbarItem</span> template<span class="token operator">=</span><span class="token string">"toolbar"</span> placement<span class="token operator">=</span><span class="token string">"navigation"</span>>
		<span class="token operator">&lt;</span><span class="token punctuation">.</span>icon name<span class="token operator">=</span><span class="token string">"person.crop.circle"</span> <span class="token operator">/</span>>
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token module class-name">ToolbarItem</span>>
	<span class="token operator">&lt;</span><span class="token module class-name">VStack</span> template<span class="token operator">=</span><span class="token string">"content"</span>>
		<span class="token operator">&lt;</span><span class="token punctuation">.</span>button<span class="token operator">></span><span class="token operator">&lt;</span><span class="token module class-name">Label</span> systemImage<span class="token operator">=</span><span class="token string">"house"</span>><span class="token module class-name">Home</span>&lt;<span class="token operator">/</span><span class="token module class-name">Label</span>><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token punctuation">.</span>button<span class="token operator">></span>
		<span class="token operator">&lt;</span><span class="token punctuation">.</span>button<span class="token operator">></span><span class="token operator">&lt;</span><span class="token module class-name">Label</span> systemImage<span class="token operator">=</span><span class="token string">"eye"</span>><span class="token module class-name">Following</span>&lt;<span class="token operator">/</span><span class="token module class-name">Label</span>><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token punctuation">.</span>button<span class="token operator">></span>
		<span class="token operator">&lt;</span><span class="token punctuation">.</span>button<span class="token operator">></span><span class="token operator">&lt;</span><span class="token module class-name">Label</span> systemImage<span class="token operator">=</span><span class="token string">"person.2"</span>><span class="token module class-name">Local</span>&lt;<span class="token operator">/</span><span class="token module class-name">Label</span>><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token punctuation">.</span>button<span class="token operator">></span>
		<span class="token operator">&lt;</span><span class="token punctuation">.</span>button<span class="token operator">></span><span class="token operator">&lt;</span><span class="token module class-name">Label</span> systemImage<span class="token operator">=</span><span class="token string">"globe"</span>><span class="token module class-name">Remote</span>&lt;<span class="token operator">/</span><span class="token module class-name">Label</span>><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token punctuation">.</span>button<span class="token operator">></span>
		<span class="token operator">&lt;</span><span class="token module class-name">Divider</span><span class="token operator">/</span>>
		<span class="token operator">&lt;</span><span class="token punctuation">.</span>button phx<span class="token operator">-</span>click<span class="token operator">=</span><span class="token string">"show_filters"</span>><span class="token operator">&lt;</span><span class="token module class-name">Label</span> systemImage<span class="token operator">=</span><span class="token string">"line.3.horizontal.decrease.circle"</span>><span class="token module class-name">Filters</span>&lt;<span class="token operator">/</span><span class="token module class-name">Label</span>><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token punctuation">.</span>button<span class="token operator">></span>
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token module class-name">VStack</span>>
<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token module class-name">VStack</span>></code></pre>
<p>And here's how it looks:</p>
<p><img src="/img/nav5.png" alt="Tab View Screenshot"></p>
<p>When the <strong>Search</strong> tab is active, we want to remove the title from the toolbar and display a button that redirects the user to the search page. Meanwhile, the rest of the page shows trending search results or other default content. This is a common pattern we observed in several social network apps like the Mastodon iOS app, IceCubes (an alternative Mastodon iOS client), and X (btw are you still relying on X as your main social presence? If so, you may want to consider moving your main presence over the fediverse, it's a way less toxic environment and not owned by a megalomaniac idiot üî•Ô∏èÔ∏èÔ∏èÔ∏èÔ∏èÔ∏è).</p>
<p>The code to build the <strong>Search Toolbar</strong> is as follows:</p>
<pre class="language-elixir"><code class="language-elixir">&lt;<span class="token module class-name">VStack</span>
  style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span>
	<span class="token string">"navigationTitle(:title)"</span><span class="token punctuation">,</span>
	<span class="token string">"toolbar(content: :toolbar)"</span><span class="token punctuation">,</span>
	<span class="token string">"navigationBarTitleDisplayMode(.inline)"</span>
  <span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token operator">></span>
	<span class="token operator">&lt;</span><span class="token module class-name">ToolbarItem</span> template<span class="token operator">=</span><span class="token string">"toolbar"</span> placement<span class="token operator">=</span><span class="token string">"principal"</span>>
		<span class="token operator">&lt;</span><span class="token module class-name">Button</span> phx<span class="token operator">-</span>click<span class="token operator">=</span><span class="token string">"go_to_search"</span> style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span>
			<span class="token string">"frame(maxWidth: .infinity)"</span><span class="token punctuation">,</span>
			<span class="token string">"controlSize(.small)"</span><span class="token punctuation">,</span>
			<span class="token string">"foregroundStyle(.gray)"</span><span class="token punctuation">,</span>
			<span class="token string">"buttonStyle(.bordered)"</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token operator">></span>
			<span class="token operator">&lt;</span><span class="token module class-name">HStack</span> style<span class="token operator">=</span><span class="token string">"frame(maxWidth: .infinity)"</span>>
				<span class="token operator">&lt;</span><span class="token punctuation">.</span>icon name<span class="token operator">=</span><span class="token string">"magnifyingglass"</span> <span class="token operator">/</span>>
				<span class="token operator">&lt;</span><span class="token module class-name">Text</span>><span class="token module class-name">Search</span>&lt;<span class="token operator">/</span><span class="token module class-name">Text</span>>
			<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token module class-name">HStack</span>>
		<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token module class-name">Button</span>>
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token module class-name">ToolbarItem</span>>
	<span class="token operator">&lt;</span><span class="token module class-name">ToolbarItemGroup</span> template<span class="token operator">=</span><span class="token string">"toolbar"</span> placement<span class="token operator">=</span><span class="token string">"navigationBarTrailing"</span>>
		<span class="token operator">&lt;</span><span class="token module class-name">Button</span>><span class="token operator">&lt;</span><span class="token punctuation">.</span>icon name<span class="token operator">=</span><span class="token string">"gear"</span> <span class="token operator">/</span>><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token module class-name">Button</span>>
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token module class-name">ToolbarItemGroup</span>>
	<span class="token operator">&lt;</span><span class="token module class-name">ToolbarItem</span> template<span class="token operator">=</span><span class="token string">"toolbar"</span> placement<span class="token operator">=</span><span class="token string">"navigation"</span>>
		<span class="token operator">&lt;</span><span class="token punctuation">.</span>icon name<span class="token operator">=</span><span class="token string">"person.crop.circle"</span> <span class="token operator">/</span>>
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token module class-name">ToolbarItem</span>>
	<span class="token operator">&lt;</span><span class="token module class-name">VStack</span> template<span class="token operator">=</span><span class="token string">"content"</span>>
		<span class="token operator">&lt;</span><span class="token punctuation">.</span>button<span class="token operator">></span><span class="token operator">&lt;</span><span class="token module class-name">Label</span> systemImage<span class="token operator">=</span><span class="token string">"house"</span>><span class="token module class-name">Home</span>&lt;<span class="token operator">/</span><span class="token module class-name">Label</span>><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token punctuation">.</span>button<span class="token operator">></span>
		<span class="token operator">&lt;</span><span class="token punctuation">.</span>button<span class="token operator">></span><span class="token operator">&lt;</span><span class="token module class-name">Label</span> systemImage<span class="token operator">=</span><span class="token string">"eye"</span>><span class="token module class-name">Following</span>&lt;<span class="token operator">/</span><span class="token module class-name">Label</span>><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token punctuation">.</span>button<span class="token operator">></span>
		<span class="token operator">&lt;</span><span class="token punctuation">.</span>button<span class="token operator">></span><span class="token operator">&lt;</span><span class="token module class-name">Label</span> systemImage<span class="token operator">=</span><span class="token string">"person.2"</span>><span class="token module class-name">Local</span>&lt;<span class="token operator">/</span><span class="token module class-name">Label</span>><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token punctuation">.</span>button<span class="token operator">></span>
		<span class="token operator">&lt;</span><span class="token punctuation">.</span>button<span class="token operator">></span><span class="token operator">&lt;</span><span class="token module class-name">Label</span> systemImage<span class="token operator">=</span><span class="token string">"globe"</span>><span class="token module class-name">Remote</span>&lt;<span class="token operator">/</span><span class="token module class-name">Label</span>><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token punctuation">.</span>button<span class="token operator">></span>
		<span class="token operator">&lt;</span><span class="token module class-name">Divider</span><span class="token operator">/</span>>
		<span class="token operator">&lt;</span><span class="token punctuation">.</span>button phx<span class="token operator">-</span>click<span class="token operator">=</span><span class="token string">"show_filters"</span>>
			<span class="token operator">&lt;</span><span class="token module class-name">Label</span> systemImage<span class="token operator">=</span><span class="token string">"line.3.horizontal.decrease.circle"</span>><span class="token module class-name">Filters</span>&lt;<span class="token operator">/</span><span class="token module class-name">Label</span>>
		<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token punctuation">.</span>button<span class="token operator">></span>
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token module class-name">VStack</span>>
<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token module class-name">VStack</span>></code></pre>
<p>Resulting in:</p>
<p><img src="/img/nav6.png" alt="Tab View Screenshot"></p>
<p>Since each tab has different buttons and items to display on the toolbar, and we can only include one toolbar per view, we needed a way to programmatically edit the toolbar based on the active tab.</p>
<p>We ended up defining a <code>Header</code> component, using <strong>slots</strong> for the different sections.</p>
<p>Here is the final code:</p>
<pre class="language-elixir"><code class="language-elixir">attr <span class="token atom symbol">:style</span><span class="token punctuation">,</span> <span class="token atom symbol">:any</span>
attr <span class="token atom symbol">:show_search</span><span class="token punctuation">,</span> <span class="token atom symbol">:boolean</span><span class="token punctuation">,</span> <span class="token attr-name">default:</span> <span class="token boolean">false</span>
attr <span class="token atom symbol">:page_title</span><span class="token punctuation">,</span> <span class="token atom symbol">:string</span><span class="token punctuation">,</span> <span class="token attr-name">default:</span> <span class="token string">""</span>
slot <span class="token atom symbol">:toolbar_trailing</span>
slot <span class="token atom symbol">:navigation_menu</span>
slot <span class="token atom symbol">:header_menu</span>

<span class="token keyword">def</span> <span class="token function">main_header</span><span class="token punctuation">(</span>assigns<span class="token punctuation">)</span> <span class="token keyword">do</span>
~<span class="token module class-name">LVN</span><span class="token string">"""
  &lt;VStack style={@style}>
	&lt;%= if @show_search do %>
	  &lt;ToolbarItem template="toolbar" placement="principal">
		&lt;Button phx-click="go_to_search" 
		  style={[
		  "frame(maxWidth: .infinity)",
		  "controlSize(.small)",
		  "foregroundStyle(.gray)",
		  "buttonStyle(.bordered)"]}>
			&lt;HStack style="frame(maxWidth: .infinity)">
			  &lt;.icon name="magnifyingglass" />
			  &lt;Text>Search&lt;/Text>
		    &lt;/HStack>
		&lt;/Button>
	  &lt;/ToolbarItem>
	&lt;% else %>
	  &lt;Text template="title"> &lt;%= @page_title %>&lt;/Text>
	&lt;% end %>
	&lt;ToolbarItemGroup template="toolbar" placement="navigationBarTrailing">
	  &lt;%= render_slot(@toolbar_trailing) %>
	&lt;/ToolbarItemGroup>
	&lt;ToolbarItemGroup template="toolbar" placement="navigation">
	  &lt;%= render_slot(@navigation_menu) %>
	&lt;/ToolbarItemGroup>
	&lt;VStack template="content">
	  &lt;%= render_slot(@header_menu) %>
	&lt;/VStack>
&lt;/VStack>
"""</span>
<span class="token keyword">end</span></code></pre>
<p>This is more Elixir than SwiftUI! üòä</p>
<p>In our <code>home_live.ex</code>, we already have a <code>handle_event</code> function responsible for updating the <code>swiftui_tab</code> value based on the tab bar's <code>phx-change=&quot;swiftui_tab_selection&quot;</code> event.</p>
<p>We added more logic to render different components in the header slots based on the active tab.</p>
<p>The remaining task was to define the correct modifiers to apply to the toolbar struct. We experienced some issues while trying to update the modifiers array directly in the template or even in the <code>handle_params</code> function.</p>
<p>For example, doing something like this did not seem to work:</p>
<pre class="language-elixir"><code class="language-elixir">&lt;<span class="token module class-name">VStack</span>
	style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span>
	<span class="token string">~s[toolbar(content: :toolbar)]</span><span class="token punctuation">,</span>
	<span class="token string">~s[navigationTitle(:title)]</span><span class="token punctuation">,</span>
	<span class="token string">~s[navigationBarTitleDisplayMode(.inline)]</span><span class="token punctuation">,</span>
	<span class="token string">~s[toolbarBackground(.visible, for: .navigationBar)]</span><span class="token punctuation">,</span>
	<span class="token string">~s[toolbarBackground(.ultraThinMaterial, for: .navigationBar)]</span>
	<span class="token punctuation">]</span> <span class="token operator">++</span> <span class="token keyword">if</span> <span class="token attribute variable">@show_header_menu</span><span class="token punctuation">,</span> <span class="token attr-name">do:</span> <span class="token punctuation">[</span><span class="token string">~s[toolbarTitleMenu(content: :content)]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token attr-name">else:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token operator">></span></code></pre>
<p>Even though the props were correctly added to the modifiers array. (Brian Carderella pointed out that these small issues will likely be resolved when the LiveView Native core library refactor is completed üéâ)</p>
<p>We achieved our goal by wrapping the style in two different classes and conditionally switching between them based on the props.</p>
<p>We've added these two classes:</p>
<pre class="language-elixir"><code class="language-elixir"><span class="token keyword">def</span> <span class="token function">class</span><span class="token punctuation">(</span><span class="token string">"main_header"</span><span class="token punctuation">)</span> <span class="token keyword">do</span>
~<span class="token module class-name">RULES</span><span class="token string">"""
	toolbar(content: :toolbar)
	navigationTitle(:title)
	toolbarTitleMenu(content: :content)
	navigationBarTitleDisplayMode(.inline)
	toolbarBackgroundVisibility(.visible, for: .navigationBar)
	toolbarBackground(.ultraThinMaterial, for: .navigationBar)
"""</span>
<span class="token keyword">end</span>

<span class="token keyword">def</span> <span class="token function">class</span><span class="token punctuation">(</span><span class="token string">"simple_header"</span><span class="token punctuation">)</span> <span class="token keyword">do</span>
~<span class="token module class-name">RULES</span><span class="token string">"""
	toolbar(content: :toolbar)
	navigationTitle(:title)
	navigationBarTitleDisplayMode(.inline)
"""</span>
<span class="token keyword">end</span></code></pre>
<p>And finally, in our <code>home_live.swiftui.neex</code></p>
<pre class="language-elixir"><code class="language-elixir">&lt;<span class="token punctuation">.</span>main_header 
  page_title<span class="token operator">=</span><span class="token punctuation">{</span><span class="token attribute variable">@page_title</span><span class="token punctuation">}</span> 
  show_search<span class="token operator">=</span><span class="token punctuation">{</span><span class="token attribute variable">@show_search</span><span class="token punctuation">}</span>
  style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">if</span> <span class="token attribute variable">@show_header_menu</span><span class="token punctuation">,</span> <span class="token attr-name">do:</span> <span class="token string">"main_header"</span><span class="token punctuation">,</span> <span class="token attr-name">else:</span> <span class="token string">"simple_header"</span><span class="token punctuation">}</span>
  <span class="token operator">&lt;</span><span class="token atom symbol">:toolbar_trailing</span>>
	<span class="token operator">&lt;</span><span class="token punctuation">%</span><span class="token operator">=</span> <span class="token keyword">case</span> <span class="token attribute variable">@toolbar_trailing</span> <span class="token keyword">do</span> <span class="token punctuation">%</span><span class="token operator">></span>
		<span class="token operator">&lt;</span><span class="token punctuation">%</span> <span class="token atom symbol">:home_toolbar_trailing</span> <span class="token operator">-></span> <span class="token punctuation">%</span><span class="token operator">></span>
		  <span class="token operator">&lt;</span><span class="token punctuation">.</span>home_toolbar_trailing <span class="token operator">/</span>>
		<span class="token operator">&lt;</span><span class="token punctuation">%</span> <span class="token atom symbol">:notifications_toolbar_trailing</span> <span class="token operator">-></span> <span class="token punctuation">%</span><span class="token operator">></span>
		  <span class="token operator">&lt;</span><span class="token punctuation">.</span>notifications_toolbar_trailing <span class="token operator">/</span>>
		<span class="token operator">&lt;</span><span class="token punctuation">%</span> <span class="token atom symbol">:search_toolbar_trailing</span> <span class="token operator">-></span> <span class="token punctuation">%</span><span class="token operator">></span>
		  <span class="token operator">&lt;</span><span class="token punctuation">.</span>search_toolbar_trailing <span class="token operator">/</span>>
		<span class="token operator">&lt;</span><span class="token punctuation">%</span> <span class="token atom symbol">:profile_toolbar_trailing</span> <span class="token operator">-></span> <span class="token punctuation">%</span><span class="token operator">></span>
		  <span class="token operator">&lt;</span><span class="token punctuation">.</span>profile_toolbar_trailing <span class="token operator">/</span>>
		<span class="token operator">&lt;</span><span class="token punctuation">%</span> <span class="token atom symbol">:direct_messages_toolbar_trailing</span> <span class="token operator">-></span> <span class="token punctuation">%</span><span class="token operator">></span>
		  <span class="token operator">&lt;</span><span class="token punctuation">.</span>direct_messages_toolbar_trailing <span class="token operator">/</span>>
		<span class="token operator">&lt;</span><span class="token punctuation">%</span> _ <span class="token operator">-></span> <span class="token punctuation">%</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token punctuation">%</span> <span class="token keyword">end</span> <span class="token punctuation">%</span><span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token atom symbol">:toolbar_trailing</span>>
  <span class="token operator">&lt;</span><span class="token atom symbol">:navigation_menu</span>>
	<span class="token operator">&lt;</span><span class="token punctuation">%</span><span class="token operator">=</span> <span class="token keyword">case</span> <span class="token attribute variable">@navigation_menu</span> <span class="token keyword">do</span> <span class="token punctuation">%</span><span class="token operator">></span>
		<span class="token operator">&lt;</span><span class="token punctuation">%</span> <span class="token atom symbol">:profile_navigation_menu</span> <span class="token operator">-></span> <span class="token punctuation">%</span><span class="token operator">></span>
			<span class="token operator">&lt;</span><span class="token module class-name">VStack</span>><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token module class-name">VStack</span>>
		<span class="token operator">&lt;</span><span class="token punctuation">%</span> _ <span class="token operator">-></span> <span class="token punctuation">%</span><span class="token operator">></span>
			<span class="token operator">&lt;</span><span class="token punctuation">.</span>navigation_menu <span class="token operator">/</span>>
	<span class="token operator">&lt;</span><span class="token punctuation">%</span> <span class="token keyword">end</span> <span class="token punctuation">%</span><span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token atom symbol">:navigation_menu</span>>
  <span class="token operator">&lt;</span><span class="token atom symbol">:header_menu</span>>
	<span class="token operator">&lt;</span><span class="token punctuation">%</span><span class="token operator">=</span> <span class="token keyword">case</span> <span class="token attribute variable">@header_menu</span> <span class="token keyword">do</span> <span class="token punctuation">%</span><span class="token operator">></span>
	  <span class="token operator">&lt;</span><span class="token punctuation">%</span> <span class="token atom symbol">:home_header_menu</span> <span class="token operator">-></span> <span class="token punctuation">%</span><span class="token operator">></span>
		<span class="token operator">&lt;</span><span class="token punctuation">.</span>home_header_menu <span class="token operator">/</span>>
	  <span class="token operator">&lt;</span><span class="token punctuation">%</span> <span class="token atom symbol">:notifications_header_menu</span> <span class="token operator">-></span> <span class="token punctuation">%</span><span class="token operator">></span>
		<span class="token operator">&lt;</span><span class="token punctuation">.</span>notifications_header_menu <span class="token operator">/</span>>
	  <span class="token operator">&lt;</span><span class="token punctuation">%</span> <span class="token atom symbol">:search_header_menu</span> <span class="token operator">-></span> <span class="token punctuation">%</span><span class="token operator">></span>
	  <span class="token operator">&lt;</span><span class="token punctuation">%</span> _ <span class="token operator">-></span> <span class="token punctuation">%</span><span class="token operator">></span>
	<span class="token operator">&lt;</span><span class="token punctuation">%</span> <span class="token keyword">end</span> <span class="token punctuation">%</span><span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token atom symbol">:header_menu</span>>
<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token punctuation">.</span>main_header<span class="token operator">></span></code></pre>
<p>This is what the result looks like:</p>
<iframe width="100%" height="515" src="https://www.youtube.com/embed/JOjgITS6rQg?si=3yoBrxvPnMADIk9V" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
<p>We can optimize the code by using a single class and concatenating dynamic props, something along the lines of:</p>
<pre class="language-elixir"><code class="language-elixir"><span class="token keyword">def</span> <span class="token function">class</span><span class="token punctuation">(</span><span class="token string">"main_header:"</span> <span class="token operator">&lt;></span> props<span class="token punctuation">)</span> <span class="token keyword">do</span>

~<span class="token module class-name">RULES</span><span class="token string">"""
  ...
"""</span>
<span class="token keyword">end</span></code></pre>
<p>Additionally, we can use <code>push_patch</code> to remember the current tab when navigating back to previous page from the Search view. We also need to iron our understanding about how SwiftUI handles the navigation stack.</p>
<p>We'll continue this work in the next article, where we'll clean up the code and make it more robust. We'll also try to include some transition effects to change the header content when scrolling down the profile page.</p>
<blockquote>
<p>From the next article, all the code will be pushed to our GitHub, making it easier for contributors to read and navigate the code.</p>
</blockquote>

  </article>


    
</div>

  <div class="mx-4 mt-8 lg:mx-auto">
    
  

  <div class="my-24 mx-auto max-w-screen-lg w-full shadow-lg flex rounded-lg bg-gradient-to-t from-base-content/5 to-base-content/40 p-[0.075rem]">
      <div class="border-b rounded-lg flex-1 flex items-center text-center gap-2 flex-col h-full border-base-content/20 bg-base-100 p-4">

        <div class="flex flex-col items-center gap-8 p-6  rounded-xl place-content-center">
          <div class="flex flex-col gap-6 mx-4 lg:mx-auto">
            <p class="text-lg font-bold tracking-tight text-base-content sm:block sm:text-4xl">Sign up to our newsletter for more stories</p>
            <div class="text-base text-base-content/80">Your data is private and we will use it only for the purposes of contacting you about Bonfire.
              <br/>You may unsubscribe at any time.
            </div>
          </div>

            <div class="flex-1 w-full" id="mc_embed_signup mt-6">
              <form action="https://bonfirenetworks.us14.list-manage.com/subscribe/post?u=d878a2618cbfbfec0b70c675a&amp;id=101bb5044b" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
              <div class="flex items-center gap-3 place-content-center" id="mc_embed_signup_scroll">
                <div class="col-span-2 mc-field-group">
                  <input type="email" value="" name="EMAIL" placeholder="Enter your email" class="w-full md:w-[360px] required email input input-bordered" id="mce-EMAIL">
                </div>
                <div id="mce-responses" class="mt-3 clear foot">
                  <div class="response" id="mce-error-response" style="display:none"></div>
                  <div class="response" id="mce-success-response" style="display:none"></div>
                </div>   
                  <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_d878a2618cbfbfec0b70c675a_101bb5044b" tabindex="-1" value=""></div>
                  <div class="optionalParent">
                      <div class="clear foot">
                          <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="normal-case btn btn-primary">
                          <p class="sr-only brandingLogo"><a href="http://eepurl.com/h4IZrH" title="Mailchimp - email marketing made easy and fun"><img src="https://eep.io/mc-cdn-images/template_images/branding_logo_text_dark_dtp.svg"></a></p>
                      </div>
                  </div>
                </div>
              </form>
              </div>
      </div>
      </div>
    </div>
    </div>

  


  <div class="border-base-content/10 bg-base-200 border-t">
 

  <div class="flex px-8 py-4 mx-auto justify-between items-center">
    <div class="flex items-start gap-4 flex-row lg:flex-col">
      <div class="flex items-center gap-2 flex-1 ">
        <span class="block bg-center bg-no-repeat bg-cover" style="width: 30px; height: 40px; background-image: url(/img/bonfire.png)"></span>
        <p class="font-bold">Bonfire Networks</p>
      </div> 
    </div> 
    <a class="github-button" href="https://github.com/bonfire-networks/bonfire-app" data-color-scheme="no-preference: dark_dimmed; light: light; dark: dark;" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star bonfire-networks/bonfire-app on GitHub">Star</a>
  </div>
  <footer class="px-8  justify-between border-t border-base-content/10 px-4 lg:mx-auto  py-8  footer text-base-content">
  <div>
    <span class="font-semibold !capitalize !text-base-content">Ecosystem</span> 
    <a href="/apps" class="link link-hover text-base-content/70">Apps</a> 
    <a href="/roadmap" class="link link-hover text-base-content/70">Extensions</a> 
    <a href="/themes" target="_blank" class="link link-hover text-base-content/70">Themes</a>
  </div> 
  <div>
    <span class="font-semibold !capitalize !text-base-content">Learn</span> 
    <a href="https://docs.bonfirenetworks.org/" target="_blank" class="link link-hover text-base-content/70">Documentation</a> 
    
    <a href="/faq" class="link link-hover text-base-content/70">FAQs</a> 
  </div> 
  <div>
    <span class="font-semibold !capitalize !text-base-content">Apps</span> 
    <a href="/start" class="link link-hover text-base-content/70">Get started</a> 
    <a href="/hosting" class="link link-hover text-base-content/70">Hosting</a> 
    <a href="https://campground.bonfire.cafe" target="_blank" class="link link-hover text-base-content/70">Demo instance</a> 
  </div> 
  <div>
    <span class="font-semibold !capitalize !text-base-content">More</span> 
    <a href="/community" class="link link-hover text-base-content/70">Participate</a> 
    <a href="/conduct" class="link link-hover text-base-content/70">Code of conduct</a> 
    <a class="link link-hover text-base-content/70" href="/contact/">Contact</a>
    <a href="/presskit" class="link link-hover text-base-content/70">Presskit</a>

  </div>
</footer>
<div class="flex px-8 border-y border-base-content/10 mx-auto  items-center justify-center py-[4vmin]">
  <div class="flex items-center place-items-center">
    <div class="flex items-center gap-3">
      <p class="text-base-content/70">Supported by</p>
      <a class="ml-4" href="https://nlnet.nl">
        <img 
          src="/img/b-nlnet.png" 
          alt="NLNet" 
          width="140" 
          loading="lazy"
          class="light-img"
        >
        <img 
          src="/img/w-nlnet.png" 
          alt="NLNet" 
          width="140" 
          loading="lazy"
          class="dark-img hidden"
        >
      </a>
    </div>
  </div>
</div>
<div class="flex px-8  mx-auto  flex-col sm:flex-row items-center justify-center sm:justify-between py-[4vmin]">
  <div class="flex items-center">
    <a class="mr-12" href="https://opencollective.com/bonfire-networks"><img src="/img/oc.svg" alt="Open Collective account" width="34" height="34" loading="lazy"></a>
    <a class="mr-12" href="https://github.com/bonfire-networks" target="_blank" rel="noopener noreferrer"><img src="/img/opensource.svg" alt="Open Source" width="89" height="34" loading="lazy"></a>
  </div>
    <nav class="hidden md:flex items-center text-sm">
      
      
      <a class="inline-block pl-2 hover:text-white" href="/">Bonfire Networks 2024</a>
    </nav>
  </div>
</div>

<script async defer>

  document.addEventListener('DOMContentLoaded', function() {
  const lightImg = document.querySelector('.light-img');
  const darkImg = document.querySelector('.dark-img');

  function updateImage() {
    const theme = document.body.getAttribute('data-theme');
    if (theme === 'light') {
      lightImg.classList.remove('hidden');
      darkImg.classList.add('hidden');
    } else {
      lightImg.classList.add('hidden');
      darkImg.classList.remove('hidden');
    }
  }

  // Initial call
  updateImage();

  // Set up a MutationObserver to watch for changes to the data-theme attribute
  const observer = new MutationObserver(updateImage);
  observer.observe(document.body, { attributes: true, attributeFilter: ['data-theme'] });
});

</script>
    <!-- Current page: /posts/dev_diary_lvn_3/ -->
  </body>
</html>