<!doctype html>
<html class="w-full antialiased" lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bonfire</title>
    <meta name="description" content="A federated social network for individuals and communities to design, operate and control their own digital lives.">
    <link rel="icon" type="image/x-icon" href="/img/favicon.ico">
    <link
    rel="stylesheet" href="/css/style_v2.css">
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/@alpinejs/intersect@3.x.x/dist/cdn.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/@alpinejs/focus@3.x.x/dist/cdn.min.js"></script>
    <script nomodule src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="Bonfire">
    <script src="//unpkg.com/alpinejs" defer></script>
    <link href="https://unpkg.com/prismjs@1.20.0/themes/prism-okaidia.css" rel="stylesheet">
  </head>
  <body data-theme="bonfire" class="body-theme w-full bg-base-100 antialiased">
    <div
      class="sticky top-0 z-[999999999999999999] transition duration-500 ease-in-out"
      x-data="{open: false, atTop: false}" 
       :class="{ 'shadow-lg': atTop, 'bg-transparent text-base-content': !atTop, 'bg-base-100 text-base-content': atTop }"
      @scroll.window="atTop = (window.pageYOffset < 50) ? false: true"
    >
    

    <div class="bg-base-300">
      <header class="relative z-30 lg:px-8 mx-auto navbar">
        <div class="navbar-start w-[70%]">
          <div class="flex  items-center flex-shrink-0">
            <a href="/" class="flex items-center space-x-4">
              <span class="block bg-center bg-no-repeat bg-cover" style="width: 30px; height: 40px; background-image: url(/img/bonfire.png)"></span>  
              <span class="flex items-center"><span class="text-base font-bold tracking-wider text-base-content">Bonfire</span> 
              
              </span>
            </a>
          </div>
           <div class="ml-4 hidden xl:flex">
          <ul class="flex-row  p-0 font-medium menu menu-compact menu-horizontal">
            <li class="dropdown">
              
              <a href="/about" role="button" tabindex="0" class="flex items-center gap-2">
                <span>About</span>
                
              </a>
              
              
            </li>
            <li class="dropdown">
                <div tabindex="0" class="flex items-center gap-2">
                  <span>Ecosystem</span>
                  <svg class="fill-current" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path d="M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"/></svg>
                </div>
              
              <ul tabindex="0" class="dropdown-content min-w-[280px] border border-base-content/30 !ml-0 menu mt-2 p-1 bg-base-300 rounded-lg">
                <li>
                  <a href="/apps" class="flex flex-col rounded-lg flex-wrap items-start">
                      <div class="font-bold">Apps</div>
                      <div class="font-light -mt-1.5  text-sm text-base-content/70 font-light">Apps built with Bonfire</div>
                  </a>
                </li>
                <li>
                  <a href="/extensions" class="flex flex-col rounded-lg flex-wrap items-start" >
                      <div class="font-bold">Extensions</div>
                      <div class="font-light -mt-1.5  text-sm text-base-content/70 font-light">Explore available extensions</div>
                  </a>
                </li>
                <li>
                  <a class="flex flex-col rounded-lg flex-wrap items-start" href="/themes">
                      <div class="font-bold">Themes</div>
                      <div class="font-light -mt-1.5  text-sm text-base-content/70 font-light">Personalize Bonfire with your preferred colors and styling</div>
                  </a>
                </li>
                  <li>
                  <a class="flex flex-col rounded-lg flex-wrap items-start" href="/pilots">
                      <div class="font-bold">Pilots</div>
                      <div class="font-light -mt-1.5  text-sm text-base-content/70 font-light">Some of the communities we are working with</div>
                  </a>
                </li>
                <li>
                  <a class="flex flex-col rounded-lg flex-wrap items-start" href="/community">
                      <div class="font-bold">How to participate</div>
                      <div class="font-light -mt-1.5  text-sm text-base-content/70 font-light">Contribute to Bonfire</div>
                  </a>
                </li>
              </ul>
            </li>
            <li class="dropdown">
                <div tabindex="0" class="flex items-center gap-2">
                  <span>Learn</span>
                  <svg class="fill-current" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path d="M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"/></svg>
                </div>
              <ul tabindex="0" class="dropdown-content min-w-[280px] border border-base-content/30 !ml-0 menu mt-2 p-1 bg-base-300 rounded-lg ">
                <li>
                  <a class="flex flex-col rounded-lg flex-wrap items-start" href="https://doc.bonfirenetworks.org">
                      <div class="font-bold">Documentation</div>
                      <div class="font-light text-sm text-base-content/70 -mt-1.5">Dive into using or building on Bonfire</div>
                  </a>
                </li>
                 <li>
                  <a class="flex flex-col rounded-lg flex-wrap items-start" href="/design">
                      <div class="font-bold">Design</div>
                      <div class="font-light text-sm text-base-content/70 -mt-1.5">Think with Bonfire to create better digital spaces</div>
                  </a>
                </li>
                <li>
                  <a class="flex rounded-lg flex-col flex-wrap items-start" href="/community">
                      <div class="font-bold">Community</div>
                      <div class="font-light text-sm text-base-content/70 -mt-1.5">How to participate in the ecosystem</div>
                  </a>
                </li>
                <li>
                  <a class="flex rounded-lg flex-col flex-wrap items-start" href="/faq">
                    <div class="font-bold">FAQ</div>
                    <div class="text-sm -mt-1.5 font-light text-base-content/70">Frequently asked questions</div>
                  </a>
                </li>
                
                <li>
                  <a class="flex flex-col rounded-lg flex-wrap items-start" href="/docs/changelog">
                    <div class="font-bold">Changelog</div>
                    <div class="font-light text-sm text-base-content/70 -mt-1.5">Latest updates and improvements</div>
                  </a></li>
                <li>
                  <a class="flex flex-col rounded-lg flex-wrap items-start" href="https://github.com/bonfire-networks/bonfire-app" target="_blank">
                    <div class="font-bold">Get the code</div>
                    <div class="font-light text-sm text-base-content/70 -mt-1.5">Bonfire is open source and AGPL3 licensed</div>
                  </a>
                </li>
              </ul>
            </li>
            
            <li>
            <a href="/hosting" class=" ">
              <span class="text-sm font-regular">Hosting</span>
            </a>
            </li>
            
       

            

            <li>
            <a href="/blog" class=" ">
              <span class="text-sm font-regular">News</span>
            </a>
            </li>
          </ul>
        </div>
        



        </div>
        
        <div class="navbar-end">
           <label for="theme_controller" class="swap swap-rotate mr-4">
  
              <!-- this hidden checkbox controls the state -->
              <input id="theme_controller" type="checkbox" class="theme-controller" value="bonfire" />
              
              <!-- sun icon -->
              <svg class="swap-on fill-current w-6 h-6" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5.64,17l-.71.71a1,1,0,0,0,0,1.41,1,1,0,0,0,1.41,0l.71-.71A1,1,0,0,0,5.64,17ZM5,12a1,1,0,0,0-1-1H3a1,1,0,0,0,0,2H4A1,1,0,0,0,5,12Zm7-7a1,1,0,0,0,1-1V3a1,1,0,0,0-2,0V4A1,1,0,0,0,12,5ZM5.64,7.05a1,1,0,0,0,.7.29,1,1,0,0,0,.71-.29,1,1,0,0,0,0-1.41l-.71-.71A1,1,0,0,0,4.93,6.34Zm12,.29a1,1,0,0,0,.7-.29l.71-.71a1,1,0,1,0-1.41-1.41L17,5.64a1,1,0,0,0,0,1.41A1,1,0,0,0,17.66,7.34ZM21,11H20a1,1,0,0,0,0,2h1a1,1,0,0,0,0-2Zm-9,8a1,1,0,0,0-1,1v1a1,1,0,0,0,2,0V20A1,1,0,0,0,12,19ZM18.36,17A1,1,0,0,0,17,18.36l.71.71a1,1,0,0,0,1.41,0,1,1,0,0,0,0-1.41ZM12,6.5A5.5,5.5,0,1,0,17.5,12,5.51,5.51,0,0,0,12,6.5Zm0,9A3.5,3.5,0,1,1,15.5,12,3.5,3.5,0,0,1,12,15.5Z"/></svg>
              
              <!-- moon icon -->
              <svg class="swap-off fill-current w-6 h-6" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21.64,13a1,1,0,0,0-1.05-.14,8.05,8.05,0,0,1-3.37.73A8.15,8.15,0,0,1,9.08,5.49a8.59,8.59,0,0,1,.25-2A1,1,0,0,0,8,2.36,10.14,10.14,0,1,0,22,14.05,1,1,0,0,0,21.64,13Zm-9.5,6.69A8.14,8.14,0,0,1,7.08,5.22v.27A10.15,10.15,0,0,0,17.22,15.63a9.79,9.79,0,0,0,2.1-.22A8.11,8.11,0,0,1,12.14,19.73Z"/></svg>
              
            </label>
          <a href="/start/" >
            <span class="hidden  normal-case rounded-full btn btn-sm btn-primary xl:flex">Get Bonfire</span>
          </a>

          <div class="inset-y-0 right-0 flex gap-3 items-center xl:hidden">
            <a href="/start/" >
              <span class="normal-case rounded-full btn btn-sm btn-primary">Get started</span>
            </a>
              <span class="sr-only">Open main menu</span>
              <label class="btn btn-circle btn-ghost swap swap-rotate">
  
              <!-- this hidden checkbox controls the state -->
              <input type="checkbox" />
              
              <!-- hamburger icon -->
              <svg @click="open = !open" class="swap-off fill-current" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 512 512"><path d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z"/></svg>
              
              <!-- close icon -->
              <svg @click="open = !open" class="swap-on fill-current" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 512 512"><polygon points="400 145.49 366.51 112 256 222.51 145.49 112 112 145.49 222.51 256 112 366.51 145.49 400 256 289.49 366.51 400 400 366.51 289.49 256 400 145.49"/></svg>
              
            </label>
          </div>

        </div>
      

    
      </header>
    </div>
    <div 
      x-description="Mobile menu, show/hide based on menu state." 
      class="xl:hidden" 
      id="mobile-menu" 
      x-show="open" 
      style="display: none;">
      <ul class="p-0 menu bg-base-300">
          <li>
            <a href="/about" class=" ">
            <span class="text-base font-regular">About</span>
          </a>
          </li>

            <li>
            <a href="/apps" class=" ">
            <span class="text-base font-regular">Apps</span>
          </a>
          </li>

          <li>
            <a href="/extensions" class=" ">
            <span class="text-base font-regular">Extensions</span>
          </a>
          </li>

          <li>
            <a href="/themes" class=" ">
            <span class="text-base font-regular">Themes</span>
          </a>
          </li>


            <li>
            <a href="/docs" class=" ">
            <span class="text-base font-regular">Documentation</span>
          </a>
          </li>

          <li>
            <a href="/courses" class=" ">
            <span class="text-base font-regular">courses</span>
          </a>
          </li>
          
          
          <li>
            <a href="/pilots" class=" ">
            <span class="text-base font-regular">Pilots</span>
          </a>
          </li>
          
          <li>
            <a href="/faq" class=" ">
            <span class="text-base font-regular">FAQs</span>
          </a>
          </li>
          <li>
          <a href="/blog" class=" ">
            <span class="text-base font-regular">News</span>
          </a>
          </li>
          <li>
            <a href="/community" class=" ">
              <span class="text-base font-regular">Community</span>
            </a>
          </li>

          <li>
            <a href="https://github.com/bonfire-networks/bonfire-app" class=" ">
              <span class="text-base font-regular">Get the code</span>
            </a>
          </li>
          
      </ul>
    </div>
  </div>

 <script>
    document.addEventListener('DOMContentLoaded', (event) => {
    const themeController = document.querySelector('.theme-controller');
    const bodyElement = document.body;

    // Load the saved theme from localStorage
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme) {
        themeController.checked = savedTheme === 'bonfire';
        bodyElement.setAttribute('data-theme', savedTheme);
    }

    // Save the theme to localStorage whenever it changes
    themeController.addEventListener('change', (event) => {
        const theme = event.target.checked ? 'bonfire' : 'light';
        localStorage.setItem('theme', theme);
        bodyElement.setAttribute('data-theme', theme);
    });
});
</script>
    


<div class="bg-base-300">
  <div class="max-w-screen-lg py-12 px-4 lg:px-0  lg:mx-auto">
    <div class="text-sm breadcrumbs">
      <ul>
        <li><a href="/extensions">Extensions</a></li> 
        
      </ul>
    </div>
    <h1 class="text-3xl font-bold text-base-content  ">bonfire_epics</h1>
    <p class="text-blueGray-300 w-full prose prose-md max-w-prose mt-2">A way of structuring task pipelines that is friendly to extensions and customisability</p>
    <div class="relative inline-block mt-6">
      
    <input value="just dep-clone-local bonfire_epics https://github.com/bonfire-networks/bonfire_epics" class="input w-[420px] input-bordered text-sm" />
    <span class="absolute right-[8px] top-[8px] btn btn-sm btn-square">
        <svg class="w-5 h-5 text-base-content/70" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M7 9.667A2.667 2.667 0 0 1 9.667 7h8.666A2.667 2.667 0 0 1 21 9.667v8.666A2.667 2.667 0 0 1 18.333 21H9.667A2.667 2.667 0 0 1 7 18.333z"/><path d="M4.012 16.737A2.005 2.005 0 0 1 3 15V5c0-1.1.9-2 2-2h10c.75 0 1.158.385 1.5 1"/></g></svg>
      </span>
    </div>
    

  </div>
</div>
<div class="my-12 max-w-screen-lg mx-auto grid grid-cols-12 gap-8 px-4 lg:px-0">

  <div class="lg:col-span-8 order-last lg:order-first col-span-12"
    <h2 class="font-semibold text-xl h-8 flex items-center">Overview</h2>

    <div class="border-base-content/30 rounded-lg border p-4 mt-8  prose max-w-full">
      <div class="uppercase tracking-widest mb-6">Readme</div>
        
        <h1 id="bonfire.epics">Bonfire.Epics <a class="direct-link" href="#bonfire.epics">#</a></h1>
<p>Epics are a extensible way of structuring tasks.</p>
<p>This library is designed to provide a structured way to define and execute complex workflows in Elixir applications. It introduces the concept of &quot;Epics&quot; and &quot;Acts&quot; to organize and run sequences of operations.</p>
<h2 id="key-components-and-concepts%3A">Key components and concepts: <a class="direct-link" href="#key-components-and-concepts%3A">#</a></h2>
<ul>
<li><code>Bonfire.Epics.Epic</code>: An Epic represents a complete workflow or process. It's a container that holds a sequence of Acts to be executed, along with state information, errors, and assigned values.</li>
<li><code>Bonfire.Epics.Act</code>: An Act is an individual step or operation within an Epic. Each Act is typically a module that implements a specific task or functionality.</li>
<li>Execution Flow &amp; Parallel Execution: Epics are executed by running their Acts in sequence. The library provides mechanisms to define, modify, and run these sequences. The library supports running multiple Acts in parallel for improved performance in certain scenarios.</li>
<li>Shared State: An Epic can maintain state throughout its execution using the 'assigns' map, allowing data to be passed between Acts.</li>
<li>Configurable: Epics can be defined in configuration, including at runtime, making it easy to set up and modify workflows without changing code.</li>
<li>Database Transactions: See the <code>Bonfire.Ecto</code> library for helpers to queue changeset operations within Acts and then run them all together in a single transaction: <a href="https://github.com/bonfire-networks/bonfire_ecto">https://github.com/bonfire-networks/bonfire_ecto</a></li>
<li>Error Handling: The library includes built-in error handling, allowing errors to be captured and associated with specific Acts within an Epic.</li>
</ul>
<p>This library is particularly useful for applications that need to manage complex, multi-step tasks with error handling and state management. It provides a flexible and extensible way to define, configure, and execute these processes, making it easier to maintain and modify complex workflows.</p>
<h2 id="how-it-works">How it works <a class="direct-link" href="#how-it-works">#</a></h2>
<ol>
<li>Each Act is implemented as a module with a <code>run/2</code> function that performs a specific task.</li>
<li>Users define an Epic, either in code or configuration, as sequences of Acts.</li>
<li>When the Epic is run, it executes each Act in sequence (or with some Acts optionally running in parallel), maintaining state and handling errors along the way. Acts can update the Epic's state, adding errors, and assigning values that can be used by subsequent Acts.</li>
<li>After all Acts are executed, the final state of the Epic is returned, including any errors or assigned values.</li>
</ol>
<h2 id="1.-how-to-write-an-act">1. How to write an Act <a class="direct-link" href="#1.-how-to-write-an-act">#</a></h2>
<p>Write a module with a <code>run/2</code> function that takes an Epic and an Act, performs a specific task, and returns an Epic.</p>
<pre class="language-elixir"><code class="language-elixir"><span class="token keyword">defmodule</span> <span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Label</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">LabelObject</span> <span class="token keyword">do</span>
  <span class="token doc"><span class="token attribute">@moduledoc</span> <span class="token string">"""
  Takes an object and label and returns a changeset for labeling that object. 
  Implements `Bonfire.Epics.Act`.

  Epic Options:
    * `:current_user` - user that will create the page, required.

  Act Options:
    * `:as` - key to where we find the label(s) to add, and then assign changeset to, default: `:label`.
    * `:object` (configurable) - id to use for the thing to label
    * `:attrs` - epic options key to find the attributes at, default: `:attrs`.
  """</span></span>

  <span class="token keyword">use</span> <span class="token module class-name">Arrows</span>
  <span class="token keyword">import</span> <span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Epics</span>

  <span class="token attribute variable">@doc</span> <span class="token boolean">false</span>
  <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>epic<span class="token punctuation">,</span> act<span class="token punctuation">)</span> <span class="token keyword">do</span>
    current_user <span class="token operator">=</span> <span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Common</span><span class="token punctuation">.</span><span class="token module class-name">Utils</span><span class="token punctuation">.</span><span class="token function">current_user</span><span class="token punctuation">(</span>epic<span class="token punctuation">.</span>assigns<span class="token punctuation">[</span><span class="token atom symbol">:options</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token keyword">cond</span> <span class="token keyword">do</span>
      epic<span class="token punctuation">.</span>errors <span class="token operator">!=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">-></span>
        <span class="token function">maybe_debug</span><span class="token punctuation">(</span>
          epic<span class="token punctuation">,</span>
          act<span class="token punctuation">,</span>
          <span class="token function">length</span><span class="token punctuation">(</span>epic<span class="token punctuation">.</span>errors<span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token string">"Skipping due to epic errors"</span>
        <span class="token punctuation">)</span>

        epic

      <span class="token function">not</span> <span class="token punctuation">(</span><span class="token function">is_struct</span><span class="token punctuation">(</span>current_user<span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token function">is_binary</span><span class="token punctuation">(</span>current_user<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-></span>
        <span class="token function">maybe_debug</span><span class="token punctuation">(</span>
          epic<span class="token punctuation">,</span>
          act<span class="token punctuation">,</span>
          current_user<span class="token punctuation">,</span>
          <span class="token string">"Skipping due to missing current_user"</span>
        <span class="token punctuation">)</span>

        epic

      <span class="token boolean">true</span> <span class="token operator">-></span>
        as <span class="token operator">=</span> <span class="token module class-name">Keyword</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>act<span class="token punctuation">.</span>options<span class="token punctuation">,</span> <span class="token atom symbol">:as</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token module class-name">Keyword</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>act<span class="token punctuation">.</span>options<span class="token punctuation">,</span> <span class="token atom symbol">:on</span><span class="token punctuation">,</span> <span class="token atom symbol">:label</span><span class="token punctuation">)</span>
        object_key <span class="token operator">=</span> <span class="token module class-name">Keyword</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>act<span class="token punctuation">.</span>options<span class="token punctuation">,</span> <span class="token atom symbol">:object</span><span class="token punctuation">,</span> <span class="token atom symbol">:object</span><span class="token punctuation">)</span>

        label <span class="token operator">=</span> <span class="token module class-name">Keyword</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>epic<span class="token punctuation">.</span>assigns<span class="token punctuation">[</span><span class="token atom symbol">:options</span><span class="token punctuation">]</span><span class="token punctuation">,</span> as<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        object <span class="token operator">=</span> <span class="token module class-name">Keyword</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>epic<span class="token punctuation">.</span>assigns<span class="token punctuation">[</span><span class="token atom symbol">:options</span><span class="token punctuation">]</span><span class="token punctuation">,</span> object_key<span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>

        <span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Label</span><span class="token punctuation">.</span><span class="token module class-name">Labelling</span><span class="token punctuation">.</span><span class="token function">label_object</span><span class="token punctuation">(</span>label<span class="token punctuation">,</span> object<span class="token punctuation">,</span>
          <span class="token attr-name">return:</span> <span class="token atom symbol">:changeset</span><span class="token punctuation">,</span>
          <span class="token attr-name">current_user:</span> current_user
        <span class="token punctuation">)</span>
        <span class="token operator">|></span> <span class="token module class-name">Map</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token atom symbol">:action</span><span class="token punctuation">,</span> <span class="token atom symbol">:insert</span><span class="token punctuation">)</span>
        <span class="token operator">|></span> <span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Epics</span><span class="token punctuation">.</span><span class="token module class-name">Epic</span><span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>epic<span class="token punctuation">,</span> as<span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">)</span>
        <span class="token operator">|></span> <span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Ecto</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Work</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token atom symbol">:label</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span></code></pre>
<h2 id="2.-how-to-define-an-epic">2. How to define an Epic <a class="direct-link" href="#2.-how-to-define-an-epic">#</a></h2>
<h3 id="simple-epic-where-each-act-executes-sequentially">Simple Epic where each Act executes sequentially <a class="direct-link" href="#simple-epic-where-each-act-executes-sequentially">#</a></h3>
<pre class="language-elixir"><code class="language-elixir">     <span class="token attribute variable">@page_act_opts</span> <span class="token punctuation">[</span><span class="token attr-name">on:</span> <span class="token atom symbol">:page</span><span class="token punctuation">,</span> <span class="token attr-name">attrs:</span> <span class="token atom symbol">:page_attrs</span><span class="token punctuation">]</span>

     config <span class="token atom symbol">:bonfire_pages</span><span class="token punctuation">,</span> <span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Pages</span><span class="token punctuation">,</span>
      <span class="token attr-name">epics:</span> <span class="token punctuation">[</span>
        <span class="token attr-name">create:</span> <span class="token punctuation">[</span>
          <span class="token comment"># Create a changeset for insertion</span>
          <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Pages</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Page</span><span class="token punctuation">.</span><span class="token module class-name">Create</span><span class="token punctuation">,</span> <span class="token attribute variable">@page_act_opts</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token comment"># with a sanitised body and tags extracted,</span>
          <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Social</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">PostContents</span><span class="token punctuation">,</span> <span class="token attribute variable">@page_act_opts</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token comment"># a caretaker,</span>
          <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Me</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Caretaker</span><span class="token punctuation">,</span> <span class="token attribute variable">@page_act_opts</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token comment"># and a creator,</span>
          <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Me</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Creator</span><span class="token punctuation">,</span> <span class="token attribute variable">@page_act_opts</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token comment"># and possibly fetch contents of URLs,</span>
          <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Files</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">URLPreviews</span><span class="token punctuation">,</span> <span class="token attribute variable">@page_act_opts</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token comment"># possibly with uploaded files,</span>
          <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Files</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">AttachMedia</span><span class="token punctuation">,</span> <span class="token attribute variable">@page_act_opts</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token comment"># with extracted tags fully hooked up,</span>
          <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Tag</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Tag</span><span class="token punctuation">,</span> <span class="token attribute variable">@page_act_opts</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token comment"># and the appropriate boundaries established,</span>
          <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Boundaries</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">SetBoundaries</span><span class="token punctuation">,</span> <span class="token attribute variable">@page_act_opts</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

          <span class="token comment"># Now we open a Postgres transaction and actually do the insertions in DB</span>
          <span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Ecto</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Begin</span><span class="token punctuation">,</span>
          <span class="token comment"># Run our inserts</span>
          <span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Ecto</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Work</span><span class="token punctuation">,</span>
          <span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Ecto</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Commit</span><span class="token punctuation">,</span>

          <span class="token comment"># Enqueue for indexing by meilisearch</span>
          <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Search</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Queue</span><span class="token punctuation">,</span> <span class="token attribute variable">@page_act_opts</span><span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">]</span></code></pre>
<h3 id="advanced-epic%2C-where-some-acts-execute-in-parallel">Advanced Epic, where some Acts execute in parallel <a class="direct-link" href="#advanced-epic%2C-where-some-acts-execute-in-parallel">#</a></h3>
<pre class="language-elixir"><code class="language-elixir">    config <span class="token atom symbol">:bonfire_posts</span><span class="token punctuation">,</span> <span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Posts</span><span class="token punctuation">,</span>
      <span class="token attr-name">epics:</span> <span class="token punctuation">[</span>
        <span class="token attr-name">publish:</span> <span class="token punctuation">[</span>
          <span class="token comment"># Create a changeset for insertion</span>
          <span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Posts</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Posts</span><span class="token punctuation">.</span><span class="token module class-name">Publish</span><span class="token punctuation">,</span>
          <span class="token comment"># These next 3 Acts are run in parallel</span>
          <span class="token punctuation">[</span>
            <span class="token comment"># with a sanitised body and tags extracted,</span>
            <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Social</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">PostContents</span><span class="token punctuation">,</span> <span class="token attr-name">on:</span> <span class="token atom symbol">:post</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment"># assign a caretaker,</span>
            <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Me</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Caretaker</span><span class="token punctuation">,</span> <span class="token attr-name">on:</span> <span class="token atom symbol">:post</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment"># record the creator,</span>
            <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Me</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Creator</span><span class="token punctuation">,</span> <span class="token attr-name">on:</span> <span class="token atom symbol">:post</span><span class="token punctuation">}</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token comment"># These next 4 Acts are run in parallel (they run after the previous 3 because they depend on the outputs of those Acts)</span>
          <span class="token punctuation">[</span>
            <span class="token comment"># possibly fetch contents of URLs,</span>
            <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Files</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">URLPreviews</span><span class="token punctuation">,</span> <span class="token attr-name">on:</span> <span class="token atom symbol">:post</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment"># possibly occurring in a thread,</span>
            <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Social</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Threaded</span><span class="token punctuation">,</span> <span class="token attr-name">on:</span> <span class="token atom symbol">:post</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment"># with extracted tags/mentions fully hooked up,</span>
            <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Tag</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Tag</span><span class="token punctuation">,</span> <span class="token attr-name">on:</span> <span class="token atom symbol">:post</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment"># maybe set as sensitive,</span>
            <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Social</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Sensitivity</span><span class="token punctuation">,</span> <span class="token attr-name">on:</span> <span class="token atom symbol">:post</span><span class="token punctuation">}</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token comment"># These next 3 Acts are run in parallel (they run after the previous 4 because they depend on the outputs of those Acts)</span>
          <span class="token punctuation">[</span>
            <span class="token comment"># possibly with uploaded/linked media (optionally depends on URLPreviews),</span>
            <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Files</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">AttachMedia</span><span class="token punctuation">,</span> <span class="token attr-name">on:</span> <span class="token atom symbol">:post</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment"># with appropriate boundaries established (depends on Threaded),</span>
            <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Boundaries</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">SetBoundaries</span><span class="token punctuation">,</span> <span class="token attr-name">on:</span> <span class="token atom symbol">:post</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment"># summarised by an activity (possibly appearing in feeds),</span>
            <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Social</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Activity</span><span class="token punctuation">,</span> <span class="token attr-name">on:</span> <span class="token atom symbol">:post</span><span class="token punctuation">}</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>

          <span class="token comment"># Now we open a Postgres transaction and actually do the insertions in DB</span>
          <span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Ecto</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Begin</span><span class="token punctuation">,</span>
          <span class="token comment"># Run our inserts</span>
          <span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Ecto</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Work</span><span class="token punctuation">,</span>
          <span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Ecto</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Commit</span><span class="token punctuation">,</span>

          <span class="token comment"># Preload data &amp; Publish live feed updates via (in-memory) PubSub</span>
          <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Social</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">LivePush</span><span class="token punctuation">,</span> <span class="token attr-name">on:</span> <span class="token atom symbol">:post</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

          <span class="token comment"># These steps are run in parallel</span>
          <span class="token punctuation">[</span>
            <span class="token comment"># Enqueue for indexing by meilisearch</span>
            <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Search</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Queue</span><span class="token punctuation">,</span> <span class="token attr-name">on:</span> <span class="token atom symbol">:post</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment"># Prepare JSON for federation and add to queue (oban).</span>
            <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Social</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Federate</span><span class="token punctuation">,</span> <span class="token attr-name">on:</span> <span class="token atom symbol">:post</span><span class="token punctuation">}</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>

          <span class="token comment"># Once the activity/object exists (depends on federation being done)</span>
          <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Tags</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">AutoBoost</span><span class="token punctuation">,</span> <span class="token attr-name">on:</span> <span class="token atom symbol">:post</span><span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">]</span></code></pre>
<h2 id="3.-how-to-run-an-epic">3. How to run an Epic <a class="direct-link" href="#3.-how-to-run-an-epic">#</a></h2>
<pre class="language-elixir"><code class="language-elixir"><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Epics</span><span class="token punctuation">.</span><span class="token function">run_epic</span><span class="token punctuation">(</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Posts</span><span class="token punctuation">,</span> <span class="token atom symbol">:publish</span><span class="token punctuation">,</span> <span class="token attr-name">on:</span> <span class="token atom symbol">:post</span><span class="token punctuation">)</span></code></pre>
<h2 id="copyright-and-license">Copyright and License <a class="direct-link" href="#copyright-and-license">#</a></h2>
<p>Copyright (c) 2022 Bonfire Contributors</p>
<p>Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);<br>
you may not use this file except in compliance with the License.<br>
You may obtain a copy of the License at</p>
<p><a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></p>
<p>Unless required by applicable law or agreed to in writing, software<br>
distributed under the License is distributed on an &quot;AS IS&quot; BASIS,<br>
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.<br>
See the License for the specific language governing permissions and<br>
limitations under the License.</p>

    </div>
  </div>
  <div class="lg:col-span-4 col-span-12 gap-4 flex flex-col">
      <div class="flex items-center space-x-3">
        <a href="https://github.com/bonfire-networks/bonfire_epics" target="_blank" class="flex-1 w-full btn btn-sm  btn-primary rounded-full">
          Get Code
        </a>
        <a target="_blank" href="https://github.com/bonfire-networks/bonfire-app/issues/new/choose" class="btn rounded-full flex-1 w-full btn-outline border-base-content/30  btn-sm">
            Report bugs
        </a>
    </div>

    

    <div class="bg-base-content/5 mt-4 rounded-lg p-3">
      <div class="uppercase text-xs tracking-widest mb-6">Details</div>
        <div class="gap-2 flex flex-col divide divide-y divide-base-content/30">
          
          <div class="pt-2 flex justify-between items-center text-sm"><span class="font-light">Updated</span> <span class="font-bold">28 Sep 2024</span></div>
          <div class="pt-2 flex justify-between items-center text-sm"><span class="font-light">License</span> <span class="font-bold">apache-2.0</span></div>
            
          
        </div>
    </div>
    
  </div>
</div>
















  <div class="border-base-content/10 bg-base-300 border-t">
 

  <div class="flex px-8 py-4 mx-auto justify-between items-center">
    <div class="flex items-start gap-4 flex-row lg:flex-col">
      <div class="flex items-center gap-2 flex-1 ">
        <span class="block bg-center bg-no-repeat bg-cover" style="width: 30px; height: 40px; background-image: url(/img/bonfire.png)"></span>
        <p class="font-bold">Bonfire Networks</p>
      </div> 
    </div> 
    <a class="github-button" href="https://github.com/bonfire-networks/bonfire-app" data-color-scheme="no-preference: dark_dimmed; light: light; dark: dark;" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star bonfire-networks/bonfire-app on GitHub">Star</a>
  </div>
  <footer class="px-8  justify-between border-t border-base-content/10 px-4 lg:mx-auto  py-8  footer text-base-content">
  <div>
    <span class="font-semibold !capitalize !text-base-content">Ecosystem</span> 
    <a href="/docs" class="link link-hover text-base-content/70">Apps</a> 
    <a href="/roadmap" class="link link-hover text-base-content/70">Extensions</a> 
    <a href="/themes" target="_blank" class="link link-hover text-base-content/70">Themes</a>
  </div> 
  <div>
    <span class="font-semibold !capitalize !text-base-content">Learn</span> 
    <a href="/docs" class="link link-hover text-base-content/70">Documentation</a> 
    <a href="/tutorials" class="link link-hover text-base-content/70">Tutorials</a> 
    <a href="/docs/faq" class="link link-hover text-base-content/70">FAQs</a> 
  </div> 
  <div>
    <span class="font-semibold !capitalize !text-base-content">Apps</span> 
    <a href="/start" class="link link-hover text-base-content/70">Get started</a> 
    <a href="/hosting" class="link link-hover text-base-content/70">Hosting</a> 
    <a href="https://campground.bonfire.cafe" target="_blank" class="link link-hover text-base-content/70">Demo instance</a> 
  </div> 
  <div>
    <span class="font-semibold !capitalize !text-base-content">More</span> 
    <a href="/community" class="link link-hover text-base-content/70">Participate</a> 
    <a href="/conduct" class="link link-hover text-base-content/70">Code of conduct</a> 
    
    <a class="link link-hover text-base-content/70" href="/contact/">Contact</a>

  </div>
</footer>
<div class="flex px-8  mx-auto  flex-col sm:flex-row items-center justify-center sm:justify-between py-[4vmin]">
  <div class="flex items-center">
    <a class="mr-12" href="https://opencollective.com/bonfire-networks"><img src="/img/oc.svg" alt="Open Collective account" width="34" height="34" loading="lazy"></a>
    <a class="mr-12" href="https://github.com/bonfire-networks" target="_blank" rel="noopener noreferrer"><img src="/img/opensource.svg" alt="Open Source" width="89" height="34" loading="lazy"></a>
  </div>
    <nav class="hidden md:flex items-center text-sm">
      
      
      <a class="inline-block pl-2 hover:text-white" href="/">Bonfire Networks 2024</a>
    </nav>
  </div>
</div>
    <!-- Current page: /extension/bonfire_epics/ -->
  </body>
</html>