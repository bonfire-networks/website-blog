<!doctype html>
<html class="w-full antialiased" lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bonfire</title>
    <meta name="description" content="A federated social network for individuals and communities to design, operate and control their own digital lives.">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">


    <link rel="icon" type="image/x-icon" href="/img/favicon.ico">

    <!-- OpenGraph meta tags for social sharing -->
    <meta property="og:title" content="Bonfire">
    <meta property="og:description" content="A federated social network for individuals and communities to design, operate and control their own digital lives.">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://bonfirenetworks.org//extension/bonfire_epics/">
    
    <!-- Twitter card tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Bonfire">
    <meta name="twitter:description" content="A federated social network for individuals and communities to design, operate and control their own digital lives.">
    
    
    <link
    rel="stylesheet" href="/css/style_v2.css?v2">
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/@alpinejs/intersect@3.x.x/dist/cdn.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/@alpinejs/focus@3.x.x/dist/cdn.min.js"></script>
    <script nomodule src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="Bonfire">
    <script src="//unpkg.com/alpinejs" defer></script>
    <link href="https://unpkg.com/prismjs@1.20.0/themes/prism-okaidia.css" rel="stylesheet">
  </head>
  <body data-theme="dark" class="body-theme w-full bg-base-100 antialiased">
      <div class="bg-base-100 flex justify-center py-2">
    <a href="https://www.indiegogo.com/projects/bonfire/community?refcode=UScVLqSJJkKpZWg_Lnsg7w" class="alert bg-secondary flex w-full justify-center rounded-none border-none p-2 text-center text-xs shadow-none">
      <svg class="w-6" xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#ecf9ff" viewBox="0 0 256 256"><path d="M184,120v61.65a8,8,0,0,1-2.34,5.65l-34.35,34.35a8,8,0,0,1-13.57-4.53L128,176ZM136,72H74.35a8,8,0,0,0-5.65,2.34L34.35,108.69a8,8,0,0,0,4.53,13.57L80,128ZM40,216c37.65,0,50.69-19.69,54.56-28.18L68.18,161.44C59.69,165.31,40,178.35,40,216Z" opacity="0.2"></path><path d="M223.85,47.12a16,16,0,0,0-15-15c-12.58-.75-44.73.4-71.41,27.07L132.69,64H74.36A15.91,15.91,0,0,0,63,68.68L28.7,103a16,16,0,0,0,9.07,27.16l38.47,5.37,44.21,44.21,5.37,38.49a15.94,15.94,0,0,0,10.78,12.92,16.11,16.11,0,0,0,5.1.83A15.91,15.91,0,0,0,153,227.3L187.32,193A15.91,15.91,0,0,0,192,181.64V123.31l4.77-4.77C223.45,91.86,224.6,59.71,223.85,47.12ZM74.36,80h42.33L77.16,119.52,40,114.34Zm74.41-9.45a76.65,76.65,0,0,1,59.11-22.47,76.46,76.46,0,0,1-22.42,59.16L128,164.68,91.32,128ZM176,181.64,141.67,216l-5.19-37.17L176,139.31Zm-74.16,9.5C97.34,201,82.29,224,40,224a8,8,0,0,1-8-8c0-42.29,23-57.34,32.86-61.85a8,8,0,0,1,6.64,14.56c-6.43,2.93-20.62,12.36-23.12,38.91,26.55-2.5,36-16.69,38.91-23.12a8,8,0,1,1,14.56,6.64Z"></path></svg>
      <div class="font-mono font-bold text-lg">Please support our crowdfunding campaign!</div> 
    </a>  
  </div>
  <div
      class="sticky bg-base-100 top-0 z-[999999999999999999] transition duration-500 ease-in-out"
      x-data="{open: false, atTop: false}" 
    >
    

    <div class="max-w-screen-lg mx-auto">
      <header class="relative z-30 lg:px-0 mx-auto navbar">
        <div class="navbar-start w-[30%]">
          <div class="flex  items-center shrink-0">
            <a href="/" class="flex items-center space-x-4">
              <span class="block bg-center bg-no-repeat bg-cover" style="width: 30px; height: 40px; background-image: url(/img/bonfire.png)"></span>  
              <span class="flex items-center"><span class="text-base font-black tracking-wider text-base-content">Bonfire Networks</span> 
              
              </span>
            </a>
          </div>
           
        



        </div>
        
        <div class="navbar-end w-[70%]">

            <div class="hidden xl:flex w-full justify-end mr-3">
          <ul class="flex-row  p-0 font-medium menu font-bold menu-horizontal">
            <li>
              <a href="/about" role="button" tabindex="0" class="flex font-semiboltext-[15px] items-center gap-2 ">
                <span>About</span>
              </a>
            </li>
            <li class="dropdown">
                <div tabindex="0" class="flex    font-semiboltext-[15px] items-center gap-2">
                  <span>Ecosystem</span>
                  <svg class="fill-current" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path d="M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"/></svg>
                </div>
              
              <ul tabindex="0" class="dropdown-content min-w-[280px] border border-base-content/20 ml-0! menu mt-2 p-1 bg-base-100 rounded-lg">
                <li>
                  <a href="/apps" class="flex flex-col rounded-lg flex-wrap items-start">
                      <div class="font-bold">Apps</div>
                  </a>
                </li>
                <li>
                  <a href="/extensions" class="flex flex-col rounded-lg flex-wrap items-start" >
                      <div class="font-bold">Extensions</div>
                  </a>
                </li>
                <li>
                  <a href="/hosting" class="flex flex-col rounded-lg flex-wrap items-start" >
                      <div class="font-bold">Hosting</div>
                  </a>
                </li>
                
                  
                
              </ul>
            </li>
            <li class="dropdown">
                <div tabindex="0" class="flex    font-semiboltext-[15px] items-center gap-2">
                  <span>Learn</span>
                  <svg class="fill-current" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path d="M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"/></svg>
                </div>
              <ul tabindex="0" class="dropdown-content min-w-[280px] border border-base-content/30 ml-0! menu mt-2 p-1 bg-base-300 rounded-lg ">
                <li>
                  <a class="flex flex-col rounded-lg flex-wrap items-start" href="https://doc.bonfirenetworks.org">
                      <div class="font-semibold">Documentation</div>
                      <div class="font-light text-sm    -mt-1.5">Dive into using or building on Bonfire</div>
                  </a>
                </li>
                 <li>
                  <a class="flex flex-col rounded-lg flex-wrap items-start" href="/design">
                      <div class="font-semibold">Design</div>
                      <div class="font-light text-sm    -mt-1.5">Think with Bonfire to create better digital spaces</div>
                  </a>
                </li>
                <li>
                  <a class="flex rounded-lg flex-col flex-wrap items-start" href="/community">
                      <div class="font-semibold">Community</div>
                      <div class="font-light text-sm    -mt-1.5">How to participate in the ecosystem</div>
                  </a>
                </li>
                <li>
                  <a class="flex rounded-lg flex-col flex-wrap items-start" href="/faq">
                    <div class="font-semibold">FAQ</div>
                    <div class="text-sm -mt-1.5 font-light   ">Frequently asked questions</div>
                  </a>
                </li>
                
                
                <li> 
                  <a class="flex flex-col rounded-lg flex-wrap items-start" href="https://github.com/bonfire-networks/bonfire-app" target="_blank">
                    <div class="font-semibold">Get the code</div>
                    <div class="font-light text-sm    -mt-1.5">Bonfire is open source and AGPL3 licensed</div>
                  </a>
                </li>
              </ul>
            </li>
            
            <li>
            <a href="/mosaic" class="font-semibold  text-[15px]  ">
              <span class="">Mosaic</span>
            </a>
            </li>

            <li>
            <a href="/blog" class="font-semibold  text-[15px]  ">
              <span class="">News</span>
            </a>
            </li>
          </ul>
        </div>

           
          <a href="/start/" >
            <span class="btn-sm w-[120px] hidden font-bold normal-case btn btn-primary xl:flex">Get Bonfire</span>
          </a>

          
          <div class="inset-y-0 right-0 flex gap-3 items-center xl:hidden">
            <a href="/start/" >
              <span class="normal-case rounded-full btn btn-sm btn-primary">Get started</span>
            </a>
              <span class="sr-only">Open main menu</span>
              <label class="btn btn-circle btn-ghost swap swap-rotate">
  
              <!-- this hidden checkbox controls the state -->
              <input type="checkbox" />
              
              <!-- hamburger icon -->
              <svg @click="open = !open" class="swap-off fill-current" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 512 512"><path d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z"/></svg>
              
              <!-- close icon -->
              <svg @click="open = !open" class="swap-on fill-current" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 512 512"><polygon points="400 145.49 366.51 112 256 222.51 145.49 112 112 145.49 222.51 256 112 366.51 145.49 400 256 289.49 366.51 400 400 366.51 289.49 256 400 145.49"/></svg>
              
            </label>
          </div>

        </div>
      

    
      </header>
    </div>
    <div 
      x-description="Mobile menu, show/hide based on menu state." 
      class="xl:hidden" 
      id="mobile-menu" 
      x-show="open" 
      style="display: none;">
      <ul class="p-0 menu bg-base-300">
          <li>
            <a href="/about" class=" ">
            <span class="text-base font-regular">About</span>
          </a>
          </li>

            <li>
            <a href="/apps" class=" ">
            <span class="text-base font-regular">Apps</span>
          </a>
          </li>

          <li>
            <a href="/extensions" class=" ">
            <span class="text-base font-regular">Extensions</span>
          </a>
          </li>

          


            <li>
            <a href="/docs" class=" ">
            <span class="text-base font-regular">Documentation</span>
          </a>
          </li>

          
          
          
          
          <li>
            <a href="/faq" class=" ">
            <span class="text-base font-regular">FAQs</span>
          </a>
          </li>
          <li>
          <a href="/blog" class=" ">
            <span class="text-base font-regular">News</span>
          </a>
          </li>
          <li>
            <a href="/community" class=" ">
              <span class="text-base font-regular">Community</span>
            </a>
          </li>

          <li>
            <a href="https://github.com/bonfire-networks/bonfire-app" class="">
              <span class="text-base font-regular">Get the code</span>
            </a>
          </li>
          
      </ul>
    </div>
  </div>

 <script>
    document.addEventListener('DOMContentLoaded', (event) => {
    const themeController = document.querySelector('.theme-controller');
    const bodyElement = document.body;

    // Load the saved theme from localStorage
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme) {
        themeController.checked = savedTheme === 'bonfire';
        bodyElement.setAttribute('data-theme', savedTheme);
    }

    // Save the theme to localStorage whenever it changes
    themeController.addEventListener('change', (event) => {
        const theme = event.target.checked ? 'bonfire' : 'light';
        localStorage.setItem('theme', theme);
        bodyElement.setAttribute('data-theme', theme);
    });
});
</script>
    


<div class="bg-base-300">
  <div class="max-w-screen-lg py-12 px-4 lg:px-0  lg:mx-auto">
    <div class="text-sm breadcrumbs">
      <ul>
        <li><a href="/extensions">Extensions</a></li> 
        
      </ul>
    </div>
    <h1 class="text-3xl font-bold text-base-content  ">bonfire_epics</h1>
    <p class="text-blueGray-300 w-full prose prose-md max-w-prose mt-2">A way of structuring task pipelines that is friendly to extensions and customisability</p>
    <div class="relative inline-block mt-6">
      
    <input value="just dep-clone-local bonfire_epics https://github.com/bonfire-networks/bonfire_epics" class="input w-[420px] input-bordered text-sm" />
    <span class="absolute right-[8px] top-[8px] btn btn-sm btn-square">
        <svg class="w-5 h-5 text-base-content/70" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M7 9.667A2.667 2.667 0 0 1 9.667 7h8.666A2.667 2.667 0 0 1 21 9.667v8.666A2.667 2.667 0 0 1 18.333 21H9.667A2.667 2.667 0 0 1 7 18.333z"/><path d="M4.012 16.737A2.005 2.005 0 0 1 3 15V5c0-1.1.9-2 2-2h10c.75 0 1.158.385 1.5 1"/></g></svg>
      </span>
    </div>
    

  </div>
</div>
<div class="my-12 max-w-screen-lg mx-auto grid grid-cols-12 gap-8 px-4 lg:px-0">

  <div class="lg:col-span-8 order-last lg:order-first col-span-12"
    <h2 class="font-semibold text-xl h-8 flex items-center">Overview</h2>

    <div class="border-base-content/30 rounded-lg border p-4 mt-8  prose max-w-full">
      <div class="uppercase tracking-widest mb-6">Readme</div>
        
        <h1 id="bonfire.epics">Bonfire.Epics <a class="direct-link" href="#bonfire.epics">#</a></h1>
<p>Epics are a extensible way of structuring tasks.</p>
<p>This library is designed to provide a structured way to define and execute complex workflows in Elixir applications. It introduces the concept of &quot;Epics&quot; and &quot;Acts&quot; to organize and run sequences of operations.</p>
<h2 id="key-components-and-concepts%3A">Key components and concepts: <a class="direct-link" href="#key-components-and-concepts%3A">#</a></h2>
<ul>
<li><code>Bonfire.Epics.Epic</code>: An Epic represents a complete workflow or process. It's a container that holds a sequence of Acts to be executed, along with state information, errors, and assigned values.</li>
<li><code>Bonfire.Epics.Act</code>: An Act is an individual step or operation within an Epic. Each Act is typically a module that implements a specific task or functionality.</li>
<li>Execution Flow &amp; Parallel Execution: Epics are executed by running their Acts in sequence. The library provides mechanisms to define, modify, and run these sequences. The library supports running multiple Acts in parallel for improved performance in certain scenarios.</li>
<li>Shared State: An Epic can maintain state throughout its execution using the 'assigns' map, allowing data to be passed between Acts.</li>
<li>Configurable: Epics can be defined in configuration, including at runtime, making it easy to set up and modify workflows without changing code.</li>
<li>Database Transactions: See the <code>Bonfire.Ecto</code> library for helpers to queue changeset operations within Acts and then run them all together in a single transaction: <a href="https://github.com/bonfire-networks/bonfire_ecto">https://github.com/bonfire-networks/bonfire_ecto</a></li>
<li>Error Handling: The library includes built-in error handling, allowing errors to be captured and associated with specific Acts within an Epic.</li>
</ul>
<p>This library is particularly useful for applications that need to manage complex, multi-step tasks with error handling and state management. It provides a flexible and extensible way to define, configure, and execute these processes, making it easier to maintain and modify complex workflows.</p>
<h2 id="how-it-works">How it works <a class="direct-link" href="#how-it-works">#</a></h2>
<ol>
<li>Each Act is implemented as a module with a <code>run/2</code> function that performs a specific task.</li>
<li>Users define an Epic, either in code or configuration, as sequences of Acts.</li>
<li>When the Epic is run, it executes each Act in sequence (or with some Acts optionally running in parallel), maintaining state and handling errors along the way. Acts can update the Epic's state, adding errors, and assigning values that can be used by subsequent Acts.</li>
<li>After all Acts are executed, the final state of the Epic is returned, including any errors or assigned values.</li>
</ol>
<h2 id="1.-how-to-write-an-act">1. How to write an Act <a class="direct-link" href="#1.-how-to-write-an-act">#</a></h2>
<p>Write a module with a <code>run/2</code> function that takes an Epic and an Act, performs a specific task, and returns an Epic.</p>
<pre class="language-elixir"><code class="language-elixir"><span class="token keyword">defmodule</span> <span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Label</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">LabelObject</span> <span class="token keyword">do</span>
  <span class="token doc"><span class="token attribute">@moduledoc</span> <span class="token string">"""
  Takes an object and label and returns a changeset for labeling that object. 
  Implements `Bonfire.Epics.Act`.

  Epic Options:
    * `:current_user` - user that will create the page, required.

  Act Options:
    * `:as` - key to where we find the label(s) to add, and then assign changeset to, default: `:label`.
    * `:object` (configurable) - id to use for the thing to label
    * `:attrs` - epic options key to find the attributes at, default: `:attrs`.
  """</span></span>

  <span class="token keyword">use</span> <span class="token module class-name">Arrows</span>
  <span class="token keyword">import</span> <span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Epics</span>

  <span class="token attribute variable">@doc</span> <span class="token boolean">false</span>
  <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>epic<span class="token punctuation">,</span> act<span class="token punctuation">)</span> <span class="token keyword">do</span>
    current_user <span class="token operator">=</span> <span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Common</span><span class="token punctuation">.</span><span class="token module class-name">Utils</span><span class="token punctuation">.</span><span class="token function">current_user</span><span class="token punctuation">(</span>epic<span class="token punctuation">.</span>assigns<span class="token punctuation">[</span><span class="token atom symbol">:options</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token keyword">cond</span> <span class="token keyword">do</span>
      epic<span class="token punctuation">.</span>errors <span class="token operator">!=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">-></span>
        <span class="token function">maybe_debug</span><span class="token punctuation">(</span>
          epic<span class="token punctuation">,</span>
          act<span class="token punctuation">,</span>
          <span class="token function">length</span><span class="token punctuation">(</span>epic<span class="token punctuation">.</span>errors<span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token string">"Skipping due to epic errors"</span>
        <span class="token punctuation">)</span>

        epic

      <span class="token function">not</span> <span class="token punctuation">(</span><span class="token function">is_struct</span><span class="token punctuation">(</span>current_user<span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token function">is_binary</span><span class="token punctuation">(</span>current_user<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-></span>
        <span class="token function">maybe_debug</span><span class="token punctuation">(</span>
          epic<span class="token punctuation">,</span>
          act<span class="token punctuation">,</span>
          current_user<span class="token punctuation">,</span>
          <span class="token string">"Skipping due to missing current_user"</span>
        <span class="token punctuation">)</span>

        epic

      <span class="token boolean">true</span> <span class="token operator">-></span>
        as <span class="token operator">=</span> <span class="token module class-name">Keyword</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>act<span class="token punctuation">.</span>options<span class="token punctuation">,</span> <span class="token atom symbol">:as</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token module class-name">Keyword</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>act<span class="token punctuation">.</span>options<span class="token punctuation">,</span> <span class="token atom symbol">:on</span><span class="token punctuation">,</span> <span class="token atom symbol">:label</span><span class="token punctuation">)</span>
        object_key <span class="token operator">=</span> <span class="token module class-name">Keyword</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>act<span class="token punctuation">.</span>options<span class="token punctuation">,</span> <span class="token atom symbol">:object</span><span class="token punctuation">,</span> <span class="token atom symbol">:object</span><span class="token punctuation">)</span>

        label <span class="token operator">=</span> <span class="token module class-name">Keyword</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>epic<span class="token punctuation">.</span>assigns<span class="token punctuation">[</span><span class="token atom symbol">:options</span><span class="token punctuation">]</span><span class="token punctuation">,</span> as<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        object <span class="token operator">=</span> <span class="token module class-name">Keyword</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>epic<span class="token punctuation">.</span>assigns<span class="token punctuation">[</span><span class="token atom symbol">:options</span><span class="token punctuation">]</span><span class="token punctuation">,</span> object_key<span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>

        <span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Label</span><span class="token punctuation">.</span><span class="token module class-name">Labelling</span><span class="token punctuation">.</span><span class="token function">label_object</span><span class="token punctuation">(</span>label<span class="token punctuation">,</span> object<span class="token punctuation">,</span>
          <span class="token attr-name">return:</span> <span class="token atom symbol">:changeset</span><span class="token punctuation">,</span>
          <span class="token attr-name">current_user:</span> current_user
        <span class="token punctuation">)</span>
        <span class="token operator">|></span> <span class="token module class-name">Map</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token atom symbol">:action</span><span class="token punctuation">,</span> <span class="token atom symbol">:insert</span><span class="token punctuation">)</span>
        <span class="token operator">|></span> <span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Epics</span><span class="token punctuation">.</span><span class="token module class-name">Epic</span><span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>epic<span class="token punctuation">,</span> as<span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">)</span>
        <span class="token operator">|></span> <span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Ecto</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Work</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token atom symbol">:label</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span></code></pre>
<h2 id="2.-how-to-define-an-epic">2. How to define an Epic <a class="direct-link" href="#2.-how-to-define-an-epic">#</a></h2>
<h3 id="simple-epic-where-each-act-executes-sequentially">Simple Epic where each Act executes sequentially <a class="direct-link" href="#simple-epic-where-each-act-executes-sequentially">#</a></h3>
<pre class="language-elixir"><code class="language-elixir">     <span class="token attribute variable">@page_act_opts</span> <span class="token punctuation">[</span><span class="token attr-name">on:</span> <span class="token atom symbol">:page</span><span class="token punctuation">,</span> <span class="token attr-name">attrs:</span> <span class="token atom symbol">:page_attrs</span><span class="token punctuation">]</span>

     config <span class="token atom symbol">:bonfire_pages</span><span class="token punctuation">,</span> <span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Pages</span><span class="token punctuation">,</span>
      <span class="token attr-name">epics:</span> <span class="token punctuation">[</span>
        <span class="token attr-name">create:</span> <span class="token punctuation">[</span>
          <span class="token comment"># Create a changeset for insertion</span>
          <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Pages</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Page</span><span class="token punctuation">.</span><span class="token module class-name">Create</span><span class="token punctuation">,</span> <span class="token attribute variable">@page_act_opts</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token comment"># with a sanitised body and tags extracted,</span>
          <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Social</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">PostContents</span><span class="token punctuation">,</span> <span class="token attribute variable">@page_act_opts</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token comment"># a caretaker,</span>
          <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Me</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Caretaker</span><span class="token punctuation">,</span> <span class="token attribute variable">@page_act_opts</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token comment"># and a creator,</span>
          <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Me</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Creator</span><span class="token punctuation">,</span> <span class="token attribute variable">@page_act_opts</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token comment"># and possibly fetch contents of URLs,</span>
          <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Files</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">URLPreviews</span><span class="token punctuation">,</span> <span class="token attribute variable">@page_act_opts</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token comment"># possibly with uploaded files,</span>
          <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Files</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">AttachMedia</span><span class="token punctuation">,</span> <span class="token attribute variable">@page_act_opts</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token comment"># with extracted tags fully hooked up,</span>
          <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Tag</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Tag</span><span class="token punctuation">,</span> <span class="token attribute variable">@page_act_opts</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token comment"># and the appropriate boundaries established,</span>
          <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Boundaries</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">SetBoundaries</span><span class="token punctuation">,</span> <span class="token attribute variable">@page_act_opts</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

          <span class="token comment"># Now we open a Postgres transaction and actually do the insertions in DB</span>
          <span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Ecto</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Begin</span><span class="token punctuation">,</span>
          <span class="token comment"># Run our inserts</span>
          <span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Ecto</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Work</span><span class="token punctuation">,</span>
          <span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Ecto</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Commit</span><span class="token punctuation">,</span>

          <span class="token comment"># Enqueue for indexing by meilisearch</span>
          <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Search</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Queue</span><span class="token punctuation">,</span> <span class="token attribute variable">@page_act_opts</span><span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">]</span></code></pre>
<h3 id="advanced-epic%2C-where-some-acts-execute-in-parallel">Advanced Epic, where some Acts execute in parallel <a class="direct-link" href="#advanced-epic%2C-where-some-acts-execute-in-parallel">#</a></h3>
<pre class="language-elixir"><code class="language-elixir">    config <span class="token atom symbol">:bonfire_posts</span><span class="token punctuation">,</span> <span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Posts</span><span class="token punctuation">,</span>
      <span class="token attr-name">epics:</span> <span class="token punctuation">[</span>
        <span class="token attr-name">publish:</span> <span class="token punctuation">[</span>
          <span class="token comment"># Create a changeset for insertion</span>
          <span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Posts</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Posts</span><span class="token punctuation">.</span><span class="token module class-name">Publish</span><span class="token punctuation">,</span>
          <span class="token comment"># These next 3 Acts are run in parallel</span>
          <span class="token punctuation">[</span>
            <span class="token comment"># with a sanitised body and tags extracted,</span>
            <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Social</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">PostContents</span><span class="token punctuation">,</span> <span class="token attr-name">on:</span> <span class="token atom symbol">:post</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment"># assign a caretaker,</span>
            <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Me</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Caretaker</span><span class="token punctuation">,</span> <span class="token attr-name">on:</span> <span class="token atom symbol">:post</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment"># record the creator,</span>
            <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Me</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Creator</span><span class="token punctuation">,</span> <span class="token attr-name">on:</span> <span class="token atom symbol">:post</span><span class="token punctuation">}</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token comment"># These next 4 Acts are run in parallel (they run after the previous 3 because they depend on the outputs of those Acts)</span>
          <span class="token punctuation">[</span>
            <span class="token comment"># possibly fetch contents of URLs,</span>
            <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Files</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">URLPreviews</span><span class="token punctuation">,</span> <span class="token attr-name">on:</span> <span class="token atom symbol">:post</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment"># possibly occurring in a thread,</span>
            <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Social</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Threaded</span><span class="token punctuation">,</span> <span class="token attr-name">on:</span> <span class="token atom symbol">:post</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment"># with extracted tags/mentions fully hooked up,</span>
            <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Tag</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Tag</span><span class="token punctuation">,</span> <span class="token attr-name">on:</span> <span class="token atom symbol">:post</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment"># maybe set as sensitive,</span>
            <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Social</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Sensitivity</span><span class="token punctuation">,</span> <span class="token attr-name">on:</span> <span class="token atom symbol">:post</span><span class="token punctuation">}</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token comment"># These next 3 Acts are run in parallel (they run after the previous 4 because they depend on the outputs of those Acts)</span>
          <span class="token punctuation">[</span>
            <span class="token comment"># possibly with uploaded/linked media (optionally depends on URLPreviews),</span>
            <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Files</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">AttachMedia</span><span class="token punctuation">,</span> <span class="token attr-name">on:</span> <span class="token atom symbol">:post</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment"># with appropriate boundaries established (depends on Threaded),</span>
            <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Boundaries</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">SetBoundaries</span><span class="token punctuation">,</span> <span class="token attr-name">on:</span> <span class="token atom symbol">:post</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment"># summarised by an activity (possibly appearing in feeds),</span>
            <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Social</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Activity</span><span class="token punctuation">,</span> <span class="token attr-name">on:</span> <span class="token atom symbol">:post</span><span class="token punctuation">}</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>

          <span class="token comment"># Now we open a Postgres transaction and actually do the insertions in DB</span>
          <span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Ecto</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Begin</span><span class="token punctuation">,</span>
          <span class="token comment"># Run our inserts</span>
          <span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Ecto</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Work</span><span class="token punctuation">,</span>
          <span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Ecto</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Commit</span><span class="token punctuation">,</span>

          <span class="token comment"># Preload data &amp; Publish live feed updates via (in-memory) PubSub</span>
          <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Social</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">LivePush</span><span class="token punctuation">,</span> <span class="token attr-name">on:</span> <span class="token atom symbol">:post</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

          <span class="token comment"># These steps are run in parallel</span>
          <span class="token punctuation">[</span>
            <span class="token comment"># Enqueue for indexing by meilisearch</span>
            <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Search</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Queue</span><span class="token punctuation">,</span> <span class="token attr-name">on:</span> <span class="token atom symbol">:post</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment"># Prepare JSON for federation and add to queue (oban).</span>
            <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Social</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">Federate</span><span class="token punctuation">,</span> <span class="token attr-name">on:</span> <span class="token atom symbol">:post</span><span class="token punctuation">}</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>

          <span class="token comment"># Once the activity/object exists (depends on federation being done)</span>
          <span class="token punctuation">{</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Tags</span><span class="token punctuation">.</span><span class="token module class-name">Acts</span><span class="token punctuation">.</span><span class="token module class-name">AutoBoost</span><span class="token punctuation">,</span> <span class="token attr-name">on:</span> <span class="token atom symbol">:post</span><span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">]</span></code></pre>
<h2 id="3.-how-to-run-an-epic">3. How to run an Epic <a class="direct-link" href="#3.-how-to-run-an-epic">#</a></h2>
<pre class="language-elixir"><code class="language-elixir"><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Epics</span><span class="token punctuation">.</span><span class="token function">run_epic</span><span class="token punctuation">(</span><span class="token module class-name">Bonfire</span><span class="token punctuation">.</span><span class="token module class-name">Posts</span><span class="token punctuation">,</span> <span class="token atom symbol">:publish</span><span class="token punctuation">,</span> <span class="token attr-name">on:</span> <span class="token atom symbol">:post</span><span class="token punctuation">)</span></code></pre>
<h2 id="copyright-and-license">Copyright and License <a class="direct-link" href="#copyright-and-license">#</a></h2>
<p>Copyright (c) 2022 Bonfire Contributors</p>
<p>Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);<br>
you may not use this file except in compliance with the License.<br>
You may obtain a copy of the License at</p>
<p><a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></p>
<p>Unless required by applicable law or agreed to in writing, software<br>
distributed under the License is distributed on an &quot;AS IS&quot; BASIS,<br>
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.<br>
See the License for the specific language governing permissions and<br>
limitations under the License.</p>

    </div>
  </div>
  <div class="lg:col-span-4 col-span-12 gap-4 flex flex-col">
      <div class="flex items-center space-x-3">
        <a href="https://github.com/bonfire-networks/bonfire_epics" target="_blank" class="flex-1 w-full btn btn-sm  btn-primary rounded-full">
          Get Code
        </a>
        <a target="_blank" href="https://github.com/bonfire-networks/bonfire-app/issues/new/choose" class="btn rounded-full flex-1 w-full btn-outline border-base-content/30  btn-sm">
            Report bugs
        </a>
    </div>

    

    <div class="bg-base-content/5 mt-4 rounded-lg p-3">
      <div class="uppercase text-xs tracking-widest mb-6">Details</div>
        <div class="gap-2 flex flex-col divide divide-y divide-base-content/30">
          
          <div class="pt-2 flex justify-between items-center text-sm"><span class="font-light">Updated</span> <span class="font-bold">10 Sep 2025</span></div>
          <div class="pt-2 flex justify-between items-center text-sm"><span class="font-light">License</span> <span class="font-bold">apache-2.0</span></div>
            
          
        </div>
    </div>
    
  </div>
</div>
















  <div class="bg-base-200">
  <div class="flex px-8 py-4 mx-auto justify-between items-center">
    <div class="flex items-start gap-4 flex-row lg:flex-col">
      <div class="flex items-center gap-2 flex-1 ">
        <span class="block bg-center bg-no-repeat bg-cover" style="width: 30px; height: 40px; background-image: url(/img/bonfire.png)"></span>
        <p class="font-bold">Bonfire Networks</p>
      </div> 
    </div> 
    <a class="github-button" href="https://github.com/bonfire-networks/bonfire-app" data-color-scheme="no-preference: dark_dimmed; light: light; dark: dark;" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star bonfire-networks/bonfire-app on GitHub">Star</a>
  </div>
  <footer class="footer pb-8 sm:footer-horizontal bg-base-200 border-base-content/10 bg-base-200 border-t pt-8 px-8 justify-between text-base-content p-10">
  <nav>
    <h6 class="footer-title">Ecosystem</h6>
    <a href="/apps" class="link link-hover">Apps</a> 
    <a href="/roadmap" class="link link-hover">Extensions</a> 
    <a href="/themes" target="_blank" class="link link-hover">Themes</a>
  </nav>
  <nav>
    <h6 class="footer-title">Learn</h6>
 <a href="https://docs.bonfirenetworks.org/" target="_blank" class="link link-hover ">Documentation</a> 
    <a href="/faq" class="link link-hover">FAQs</a> 
    <a href="/conduct" class="link link-hover">Code of conduct</a> 
    
  </nav>
  <nav>
    <h6 class="footer-title">Apps</h6>
    <a href="/start" class="link link-hover">Get started</a> 
    <a href="/hosting" class="link link-hover">Hosting</a> 
    <a href="https://campground.bonfire.cafe" target="_blank" class="link link-hover">Demo instance</a> 
  </nav>
  <div>
    <h6 class="footer-title">More</h6>
    <a class="link link-hover" href="/contact/">Contact</a>
    <a href="/presskit" class="link link-hover">Presskit</a>
    
    <form action="https://bonfirenetworks.us14.list-manage.com/subscribe/post?u=d878a2618cbfbfec0b70c675a&amp;id=101bb5044b" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
              <div class="flex items-center gap-1" id="mc_embed_signup_scroll">
                <div class="col-span-2 mc-field-group">
                  <input type="email" value="" name="EMAIL" placeholder="Enter your email" class="w-full required email input input-bordered" id="mce-EMAIL">
                </div>
                <div id="mce-responses" class="mt-3 clear foot">
                  <div class="response" id="mce-error-response" style="display:none"></div>
                  <div class="response" id="mce-success-response" style="display:none"></div>
                </div>   
                  <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_d878a2618cbfbfec0b70c675a_101bb5044b" tabindex="-1" value=""></div>
                  <div class="optionalParent">
                      <div class="clear foot">
                          <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="normal-case btn btn-primary">
                          <p class="sr-only brandingLogo"><a href="http://eepurl.com/h4IZrH" title="Mailchimp - email marketing made easy and fun"><img src="https://eep.io/mc-cdn-images/template_images/branding_logo_text_dark_dtp.svg"></a></p>
                      </div>
                  </div>
                </div>
              </form>
  </div>
</footer>
<div class="flex px-8 border-y border-base-content/10 mx-auto  items-center justify-center py-[4vmin]">
  <div class="flex items-center place-items-center">
    <div class="flex items-center gap-3">
      <p class="text-base-content/70">Supported by</p>
      <a class="ml-4" href="https://nlnet.nl">
        <img 
          src="/img/b-nlnet.png" 
          alt="NLNet" 
          width="140" 
          loading="lazy"
          class="light-img"
        >
        <img 
          src="/img/w-nlnet.png" 
          alt="NLNet" 
          width="140" 
          loading="lazy"
          class="dark-img hidden"
        >
      </a>
    </div>
  </div>
</div>
<div class="flex px-8  mx-auto  flex-col sm:flex-row items-center justify-center sm:justify-between py-[4vmin]">
  <div class="flex items-center">
    <a class="mr-12" href="https://opencollective.com/bonfire-networks"><img src="/img/oc.svg" alt="Open Collective account" width="34" height="34" loading="lazy"></a>
    <a class="mr-12" href="https://github.com/bonfire-networks" target="_blank" rel="noopener noreferrer"><img src="/img/opensource.svg" alt="Open Source" width="89" height="34" loading="lazy"></a>
  </div>
    <nav class="hidden md:flex items-center text-sm">
      
      
      <a class="inline-block pl-2 hover:text-white" href="/">Bonfire Networks 2025</a>
    </nav>
  </div>
</div>

<script async defer>

  document.addEventListener('DOMContentLoaded', function() {
  const lightImg = document.querySelector('.light-img');
  const darkImg = document.querySelector('.dark-img');

  function updateImage() {
    const theme = document.body.getAttribute('data-theme');
    if (theme === 'light') {
      lightImg.classList.remove('hidden');
      darkImg.classList.add('hidden');
    } else {
      lightImg.classList.add('hidden');
      darkImg.classList.remove('hidden');
    }
  }

  // Initial call
  updateImage();

  // Set up a MutationObserver to watch for changes to the data-theme attribute
  const observer = new MutationObserver(updateImage);
  observer.observe(document.body, { attributes: true, attributeFilter: ['data-theme'] });
});

</script>
    <!-- Current page: /extension/bonfire_epics/ -->
  </body>
</html>